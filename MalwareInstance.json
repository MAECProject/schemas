{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "MalwareInstanceType": {
	    "title":"MalwareInstance",
            "type": "object",
            "description": "The MalwareInstanceType captures all of the details pertaining to a single malware instance, including any corresponding Analyses, Field Data, Findings Bundles, and relationships to other Malware Instances.",
            "properties": {
                "type": {
                    "type": "string",
                    "enum": ["malware-instance"]
                },
                "id": {
                    "type": "string",
                    "description": "The required id field specifies a unique ID for this Malware Instance."
                },
                "instance_object_refs": {
                    "type": "array",
                    "items": {"$ref": "REFERENCE PLACEHOLDER FOR Cyber Observable Object type spec 3.0"},
		            "description":"References the Cyber Observable Objects (most commonly a File Object) that represents the malware instance characterized by the Malware Instance. For cases where multiple Cyber Observable File Objects are referenced by this property, these Objects MUST have the same hash (via the hashes property) but MAY have different filenames (via the file_name property)"
		        },
                "targeted_operating_systems":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"Captures the operating systems tageted by the Malware Instance. The values for this property SHOULD come from the operating-system-ov vocabulary"
                },
                "metadata":{
                    "$ref":"#/definitions/InstanceMetadataType",
                    "description":"Specifies general metadata about the Malware Instance (e.g. names, labels)"
                },
                "capabilities":{
                    "type":"array",
                    "items":{"$ref":"Capability.json#/definitions/CapabilityType"},
                    "description": "Specifies a set of one or more Capabilities possessed by the Malware Instance/"
                },
                "os_features":{
                    "type":"array",
                    "items":{"type": "string"},
                    "description":"Specifies any operating system-specific features used by the malware instance. Each item in the list specifies a single feature. The values for this property SHOULD come from the os-features-android-ov, os-features-ios-ov, os-features-linux-ov, os-features-macosx-ov or os-features-windows-ov vocabularies"
                },
                "structural_features":{
                    "type":"array",
                    "items":{"$ref":"#/definitions/StructuralFeatureType"},
                    "description":"Specifies a set of one or more features associated with how the code is structured in the binary (e.g. import address table obfuscation). The values for this property SHOULD come form the structural-features-ov"
                },
                "behavioral_features":{
                    "type":"array",
                    "items":{"$ref":"#/definitions/BehavioralFeatureType"},
                    "description":" Captures features associated witht the semantics of the code executed by the Malware Instance."
                },
                "static_features":{
                    "type":"array",
                    "items":{"$ref":"#/definitions/StaticFeatureType"}
                },
                "analysis_metadata":{
                    "$ref":"#/definitions/AnalysisMetadataType",
                    "description":"Captures metadata associated with the analysis performed on the Malware Instance (e.g. tools used)."
                }
            },
            "required": [
                "type",
                "id",
                "instance_object_refs"
            ]
        },
        "InstanceMetadataType":{
            "title":"InstanceMetadata",
            "type":"object",
            "description":"Captures the metadata associated with a malware instance",
            "properties":{
                "name":{
                    "$ref":"#/definitions/NameType",
                    "description":"Captures the name of the malware instance characterized by the Malware Instance. These names are assigned by the producer of the MAEC document, and may come from various sources, including from an analyst or as reported by a tool (e.g. and AV classification tool)"
                },
                "aliases":{
                    "type":"array",
                    "items":{"$ref":"#/definitions/NameType"},
                    "description":"Captures any aliases for the malware instance name associated with the Malare Instance, as reported by sources outher than the producer of the MAEC document."
                },
                "delivery_vectors":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"Specifies the vectors used to distribute/deploy the Malware Instance. The values for this property SHOULD come from the delivery-vector-ov vocabulary"
                },
                "first_seen":{
                    "type":"string",
                    "pattern":"([0-9]{4})-([0-9]{2})-([0-9]{2}T[0-9]{2}):([0-9]{2}):([0-9]{2}).(*[0-9])Z",
                    "description":"Specifies the date/time that the malware instance was first seen by the producer of the Malware Instance Object"
                },
                "last_seen":{
                    "type":"string",
                    "pattern":"([0-9]{4})-([0-9]{2})-([0-9]{2}T[0-9]{2}):([0-9]{2}):([0-9]{2}).(*[0-9])Z",
                    "description":"Specifies the date/time that the malware instance was last seen by the producer of the Malware Instance Object"
                },
                "labels":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"Specifies a single commonly accepted label to describe the Malware Instance, e.g. \"worm\". The values for this property SHOULD come form the malware-label-ov vocabulary."
                }
            }
        },
        "BehavioralFeatureType":{
            "title":"BehavioralFeature",
            "type":"object",
            "description":"Captures the behavioral features of a malware instance.",
            "properties":{
                "behavior_refs":{
                    "type":"array",
                    "items":{"type": "string"},
                    "description":"Specifies a set of one or more Behaviors exhibited by the Malware Instance. Each item specifies the unique ID of the Behavior being referenced."
                },
                "action_refs":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description": "Specifies a set of one or more Actions discovered for the Malware Instance. Each item specifies the unique ID of the Action being referenced."
                },
                "process_tree_refs":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"Specifies a set of one or more Process Trees observed during one or more executions of Malware Instance. Each item specifies the unique ID of the Processs Tree being referenced."
                }
            }
        },
        "StaticFeatureType":{
            "title":"StaticFeature",
            "type":"object",
            "description":"Captures features associated with a malware binary not related to the semantics of the code.",
            "properties":{
                "strings":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"Captures strings extracted from the binary"
                },
                "packers":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"References the Cyber Observable Objects reflecting the packers used in the Malware Instance. Each item specifies the unique ID of the Cyber Obserable object being referenced. The Cyber Observable Objects referenced in this field MUST be of type software"
                },
                "certificates":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"References any software certificates used to sign the malware binary associated witht the malware instance. The Cyber Observable Objects referenced in this field MUST be for the type x509-certificate"
                },
                "file_headers":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"References any file headers (e.g. PE file headers) extracted from the binary. The cyber Observable Objects referenced in this field MUST be of the type file."
                },
                "configuration_details":{
                    "$ref":"MalwareConfigurationDetailsType.json/definitions/MalwareConfigurationDetailsType",
                    "description":"Captures details of the configuration specified for the Malware Instance, such as the configuration parameters."
                },
                "development_environment":{
                    "$ref":"#/definitions/MalwareDevelopmentEnvironmentType",
                    "description":"Captures the details of the development environment used in the creation of the malware instance object characterized by the Malware Instance"
                }
            }
        },
        "MalwareDevelopmentEnvironmentType": {
        "title":"MalwareDevelopmentEnvironment",
            "type": "object",
            "description": "The MalwareDevelopmentEnvironmentType captures details of the development environment used in developing the malware instance, such as information on any tools that were used.",
            "properties": {
                "tool_refs": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "Captures a set of references to one or more tools used in the development of the malware instance. Values MUST reference a Software Object in the objects field at the top-level of the Package."
                },
                "debugging_file_refs": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "Captures the properties of a debugging file associated with the malware instance, such as a PDB file. Values MUST reference a File Object, which will use the FileObjectType from the imported File Object Schema. More than one debugging_file field can be specified by using multiple instances of this field."
                }
            },
            "required":[
                "tool_refs"
            ]
        },
        "StructuralFeatureType":{
        "title":"StructuralFeature",
            "type":"object",
            "description":"Captures features associated with the structure or layout of a malware binary but not its semantics (e.g. entrypoint obfuscation).",
            "properties":{
                "name":{
                    "type":"string",
                    "description":"Captures the name of the structual Feature. The values for this property SHOULD come from the structural-feature-ov vocabulary"
                },
                "description":{
                    "type":"string",
                    "description":"Captures the basic textual description of the Structural Feature"
                },
                "attributes":{
                    "type":"array",
                    "items":{"$ref":"Behavior.json/definitions/AttributeType"},
                    "description":"Captures a single attribute of the Structural Feature, as a name/value pair."
                }
            },
            "required":[
                "name"
            ]
        },
        "AnalysisMetadataType":{
            "title":"AnalysisMetadata",
            "type":"object",
            "description":"Captures metadata associated with the analyses of a malware instance, such as the tools used, analysts, other data",
            "properties":{
                "analysts":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"Specifies the analysts who did the analysis."
                },
                "comments":{
                    "type":"array",
                    "items":{"$ref":"#/definitions/CommentType"},
                    "description":"Specifies any comments regarding the analysis that was performed. A comment shoudl be attributable to a specific analyst and should reflect particular insights of the author that are significant from an analysis standpoint. The contents of comments are typically not contained in the report. "
                },
                "tool_refs":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description":"Captures a set of references to one or more Tools used in the analysis of a Malware Instance. Values MUST be references to Software Objects in the objects field at the top-level of the Package."
                },
                "summary":{
                    "type":"string",
                    "description":"Captures a textual summary regarding the analyses performed on the malware"
                }
            }
        },
        "CommentType":{
            "title":"Comment",
            "type":"object",
            "description":"Captures a comment relating to some MAEC field",
            "properties":{
                "comment":{
                    "type":"string",
                    "description":"specifies the actual comment"
                },
                "author":{
                    "type":"string",
                    "description":"specifies the name of the author that added the comment"
                },
                "timestamp":{
                    "type": "string",
                    "pattern":"([0-9]{4})-([0-9]{2})-([0-9]{2}T[0-9]{2}):([0-9]{2}):([0-9]{2}).(*[0-9])Z",
                    "description":"specifies the date/time that the comment was added"
                },
                "observation_name":{
                    "type": "string",
                    "description":"Captures the name, type, or identifier of an observation, for comments that refer to the observation of particular entities. For example, a comment that refers to a command and control (C2) encryption key could have an observation_name of \"C2 Encryption Key\". "
                }
            }
        },
        "NameType": {
  	    "title":"Name",
            "type": "object",
            "description": "The NameType captures the name of a malware instance or malware family and the relative confidence of the name.",
            "properties": {
                "value": {
                    "type": "string",
                    "description": "The value field specifies the name of the malware instance or malware family."
                },
                "source":{
                    "$ref":"#/definitions/SourceType",
                    "description":""
                },
                "confidence": {
                    "type": "string",
                    "description": "The confidence field specifies the relative confidence in the accuracy of the assigned malware instance name. The suggested vocabulary for this field is confidence-measure-ov."
                }
            },
            "required": ["value"]
        },
        "SourceType":{
            "title":"Source",
            "type":"object",
            "description":"Provides a way of characterizing the external source of a relevant MAEC entity, such as an Analysis.",
            "properties":{
                "name":{
                    "type":"string",
                    "description":"refers to the name of the person linked to the source"
                },
                "method":{
                    "type":"string",
                    "description":"The method field provides an abstract way of specifying the method used to obtain the data that the Source element refers to."
                },
                "references":{
                    "type":"string",
                    "format":"uri",
                    "description":"The reference field provides an abstract way of specifying one or more external references for the source."
                },
                "organization":{
                    "type":"string",
                    "description":"The organization field specifies the name of the organization from which the source originated."
                }
            }

        }
    }
}
