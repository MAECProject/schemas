{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "MalwareInstanceType": {
	       "title":"MalwareInstance",
            "type": "object",
            "description": "Captures all of the details pertaining to a single malware instance, including any corresponding Analyses, Field Data, Findings Bundles, and relationships to other Malware Instances.",
            "properties": {
                "type": {
                    "type": "string",
                    "enum": ["malware-instance"]
                },
                "id": {
                    "type": "string",
                    "description": "Specifies a unique ID for this Malware Instance."
                },
                "instance_object_refs": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "References the Cyber Observable Objects that represents the malware instance characterized by the Malware Instance. For most use cases, the Object referenced SHOULD be of type file. For cases where multiple Cyber Observable File Objects are referenced by this property, each Object MUST have the same hash value (via the hashes property) but MAY have different file names (via the name property). "
		        },
                "name": {
                    "$ref": "Name.json#/definitions/NameType",
                    "description": "Captures the name of the malware instance characterized by the Malware Instance. These names are assigned by the producer of the MAEC document, and may come from various sources, including from an analyst or as reported by a tool (e.g., an AV classification tool)."
                },
                "aliases": {
                    "type": "array",
                    "items": {"type": "Name.json#/definitions/NameType"},
                    "description": "Captures any aliases for the malware instance name associated with the Malware Instance, as reported by sources other than the producer of the MAEC document (e.g., AV vendors)."
                },
                "labels": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "Specifies a single commonly accepted the label to describe the Malware Instance, e.g. \"worm\". The values for this property SHOULD come from the malware-label-ov vocabulary."
                },
                "description": {
                    "type": "string",
                    "description": "Captures a basic, textual description of the Malware Instance."
                },
                "field_data":{
                    "$ref": "FieldData.json#/definitions/FieldDataType",
                    "description": "Specifies general metadata about the Malware Instance (e.g. first seen and last seen dates)."
                },
                "os_execution_envs": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "Specifies the operating systems that the Malware Instance executes on. The values for this property SHOULD come from the operating-system-ov vocabulary."
                },
                "architecture_execution_envs": {
                    "type": "array",
                    "items":{"type": "string"},
                    "description": "Specifies the processor architecture(s) that the Malware Instance executes on. The values for this property SHOULD come from the processor-architecture-ov vocabulary."
                },
                "capabilities":{
                    "type":"array",
                    "items":{"$ref":"Capability.json#/definitions/CapabilityType"},
                    "description": "Specifies a set of one or more Capabilities possessed by the Malware Instance."
                },
                "os_features":{
                    "type":"array",
                    "items":{"type": "string"},
                    "description":"Specifies any operating system-specific features used by the malware instance. Each item in the list specifies a single feature. The values for this property SHOULD come from the os-features-android-ov, os-features-ios-ov, os-features-linux-ov, os-features-macosx-ov or os-features-windows-ov vocabularies"
                },
                "dynamic_features":{
                    "$ref": "DynamicFeatures.json#/definitions/DynamicFeaturesType",
                    "description": "Captures features associated with the semantics of the code executed by the Malware Instance. Note that DynamicFeaturesType captures multiple features."
                },
                "static_features":{
                    "items": {"$ref": "StaticFeatures.json#/definitions/StaticFeatureType"},
                    "description": "Captures features associated with the binary that arent related to the semantics of the code (e.g. strings, packer information). Note that StaticFeaturesType captures multiple static features."
                },
                "analysis_metadata": {
                    "type": "array",
                    "items": {"$ref": "AnalysisMetadata.json#/definitions/AnalysisMetadataType"},
                    "description": "Captures metadata associated with the analyses performed on the Malware Instance (e.g., the tools that were used)."
                },
                "triggered_signatures": {
                    "type": "array",
                    "items": {"$ref": "SignatureMetadata.json#/definitions/SignatureMetadataType"},
                    "description": "Captures metadata associated with any signatures or rule (e.g. YARA) that were triggered during the analysis of the malware instance."
                }
            },
            "required": [
                "type",
                "id",
                "instance_object_refs"
            ]
        }
    }
}
