{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "MalwareInstanceType": {
            "type": "object",
            "description": "The MalwareInstanceType captures all of the details pertaining to a single malware instance, including any corresponding Analyses, Field Data, Findings Bundles, and relationships to other Malware Instances.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "The required id field specifies a unique ID for this Malware Instance."
                },
                "instance_object": {
                    "$type": "string",
                    "description": "The instance_object field references the CybOX Object (most commonly a File Object) that represents the malware instance whose Capabilities, Behaviors, Actions, Objects, and Process Tree are characterized in a Malware Instance of a MAEC Package. The string specifies the id of the object being referenced."
                },
                "malware_name": {
                    "$ref": "#/definitions/NameType",
                    "description": "The malware_name field captures the name of the malware instance characterized by the Malware Instance. These names are assigned by the producer of the MAEC document, and may come from various sources, including from an analyst or as reported by a tool (e.g., an AV classification tool)."
                },
                "malware_aliases": {
                    "type": "array",
                    "items": {"$ref": "#/definitions/MalwareAliasType"},
                    "description": "The malware_aliases field captures any aliases for the malware instance name associated with the Malware Instance, as reported by sources other than the producer of the MAEC document (e.g., AV vendors)."
                },
                "minor_variants": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "The minor_variants field captures any minor variants of the malware instance object, such as the same file but with different filenames. These differences between two malware samples are minor, so minor that they do not mean that the two samples are variants of the same family. The field specifies the id of the object being referenced"
                },
                "label": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "The label field specifies a single commonly accepted label to describe the Malware Subject, e.g. worm. The default vocabulary for this field is the MalwareLabelVocab-1.0 from the MAEC Default Vocabularies schema. More than one label may be specified through the use of multiple instances of this field."
                },
                "configuration_details": {
                    "$ref": "#/definitions/MalwareConfigurationDetailsType",
                    "description": "The configuration_details field captures details of the configuration specified for the Malware Instance, such as configuration parameters."
                },
                "development_environment": {
                    "$ref": "#/definitions/MalwareDevelopmentEnvironmentType",
                    "description": "The development_environment field captures details of the development environment used in the creation of the malware instance characterized by the Malware Instance."
                },
                "compatible_platform": {
                    "type": "array",
                    "items": {"$ref": "REFERENCE PLACEHOLDER FOR cyboxCommon:PlatformSpecificationType"},
                    "description": "The compatible_platform field specifies a single platform that the Malware Instance is compatible with (i.e. can execute on). More than one compatible platform can be specified by using multiple occurrences of this field."
                },
                "field_data": {
                    "$ref": "REFERENCE PLACEHOLDER FOR metadata:fieldDataEntry",
                    "description": "The field_data field captures field data and prevalance information relating to the Malware Instance. It uses the fieldDataEntry type from the MMDEF v1.2 schema."
                },
                "analyses": {
                    "type": "array",
                    "items": {"$ref": "AnalysisType.json#/definitions/AnalysisType"},
                    "description": "The analyses field captures any Analyses (including their associated metadata such as tools used, etc.) that were performed on the Malware Instance."
                },
                "capabilities": {
                    "type": "array",
                    "items": {"$ref": "Capability.json#/definitions/CapabilityType"},
                    "description": "The capabilities field specifies a set of one or more Capabilities possessed by the Malware Instance."
                },
                "behaviors": {
                    "type": "array",
                    "items": {"$ref": "Behavior.json#/definitions/BehaviorType"},
                    "description": "The behaviors field specifies a set of one or more Behaviors exhibited by the Malware Instance."
                },
                "actions": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "The actions field specifies a set of one or more Actions discovered for the Malware Instance. Each item refers to an id oft eh action being referenced."
                },
                "objects": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "The object field specifies a set of one or more Objects discovered for the Malware Instance. Each object item specifies the id of the CybOX object being referenced."
                },
                "process_trees": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "The process_trees field specifies a set of one or more Process Trees observed during one or more executions of the Malware Instance. Each item references an existing Process Tree defined in the MAEC document, via its ID."
                },
                "static_features": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "The static_features field specifies a set of one or more Object references related to the malware instance characterized by the Malware Instance. Each item specifies the id of the CybOX object being referenced."
                }
            },
            "required": ["id"]
        },
        "MalwareAliasType": {
            "type": "object",
            "description": "The MalwareAliasType captures name information associated with an alias.",
            "properties": {
                "name": {
                    "$ref": "#/definitions/NameType",
                    "description": "The name field captures the name of the malware instance that is characterized by the Malware Instance."
                },
                "source": {
                    "$ref": "Analysis.json#/definitions/SourceType",
                    "description": "The source field specifies the source of the malware instance or family names captured in the malware_name field."
                }
            }
        },
        "MalwareDevelopmentEnvironmentType": {
            "type": "object",
            "description": "The MalwareDevelopmentEnvironmentType captures details of the development environment used in developing the malware instance, such as information on any tools that were used.",
            "properties": {
                "tools": {
                    "type": "string",
                    "description": "The tools field captures a set of references to one or more Tools used in the development of the malware instance. Values MUST be references to Software Objects in the objects field at the top-level of the Package."
                },
                "debugging_file": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "The debugging_file field captures the properties of a debugging file associated with the malware instance, such as a PDB file. It MUST reference a File Object, which will use the FileObjectType from the imported File Object Schema. More than one debugging_file field can be specified by using multiple instances of this field."
                }
            }
        },
        "NameType": {
            "type": "object",
            "description": "The NameType captures the name of a malware instance or malware family and the relative confidence of the name.",
            "properties": {
                "name": {
                    "type": "string",
                    "description": "The name field specifies the name of the malware instance or malware family."
                },
                "confidence": {
                    "$ref": "Vocabs.json#/definitions/ConfidenceMeasureEnum",
                    "description": "The confidence field specifies the relative confidence in the accuracy of the assigned malware instance name."
                }
            },
            "required": ["name"]
        },
        "MalwareConfigurationDetailsType": {
            "type": "object",
            "description": "The MalwareConfigurationDetailsType captures details of malware configuration parameters and associated metadata.",
            "properties": {
                "storage": {
                    "$ref": "MalwareConfigurationDetails.json#/definitions/MalwareConfigurationStorageDetailsType",
                    "description": "The storage field captures details of the how the malware configuration parameters may be stored, e.g. in a separate file, in memory, etc."
                },
                "obfuscation": {
                    "$ref": "MalwareConfigurationDetails.json#/definitions/MalwareConfigurationObfuscationDetailsType",
                    "description": "The obfuscation field captures details of how the malware configuration parameters may be obfuscated, if applicable."
                },
                "configuration_parameter": {
                    "type": "array",
                    "items": {"$ref": "MalwareConfigurationDetails.json#/definitions/MalwareConfigurationParameterType"},
                    "description": "The configuration_parameter field captures a single configuration parameter that may be defined for the Malware Instance. More than one configuration parameter may be specified by using multiple occurrences of this field."
                }
            }
        }
    }
}