<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Package Multiple Analysis Example
 -Demonstrates how multiple analyses for the same Malware Subject (a Zeus binary in this case) can be combined
 -Shows ThreatExpert and Anubis analyses for the same malware instance (outputs were trimmed for readability)
 -Also, shows usage of Bundle Collections
 
 Created November 2012 for MAEC v3.0 and CybOX v1.0 final-->
<maecPackage:MAEC_Package
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-1"
 xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-3"
 xmlns:cybox="http://cybox.mitre.org/cybox_v1"
 xmlns:Common="http://cybox.mitre.org/Common_v1"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject"
 xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject"
 xmlns:MutexObj="http://cybox.mitre.org/objects#MutexObject"
 xmlns:WinMutexObj="http://cybox.mitre.org/objects#WinMutexObject"
 xmlns:WinRegistryKeyObj="http://cybox.mitre.org/objects#WinRegistryKeyObject"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-package-3 ../maec-package-schema.xsd 
 http://maec.mitre.org/XMLSchema/maec-bundle-3 ../maec-bundle-schema.xsd 
 http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/Win_Executable_File_Object_1.3.xsd
 http://cybox.mitre.org/objects#WinMutexObject http://cybox.mitre.org/XMLSchema/objects/Win_Mutex/Win_Mutex_Object_1.2.xsd 
 http://cybox.mitre.org/objects#WinProcessObject http://cybox.mitre.org/XMLSchema/objects/Win_Process/Win_Process_Object_1.3.xsd 
 http://cybox.mitre.org/objects#WinRegistryKeyObject http://cybox.mitre.org/XMLSchema/objects/Win_Registry_Key/Win_Registry_Key_Object_1.3.xsd" 
 id="maec-example-pkg-1" schema_version="1.0">

 <maecPackage:Malware_Subjects>
  <maecPackage:Malware_Subject id="maec-example-sub-1">
   <maecPackage:Subject_Attributes>
     <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
      <FileObj:File_Name datatype="String">076e5b2bae.exe</FileObj:File_Name>
      <FileObj:File_Path datatype="String">C:\076e5b2bae.exe</FileObj:File_Path>
      <FileObj:Size_In_Bytes datatype="UnsignedLong">77312</FileObj:Size_In_Bytes>
      <FileObj:Hashes>
       <Common:Hash>
        <Common:Type datatype="String">MD5</Common:Type>
        <Common:Simple_Hash_Value datatype="hexBinary">076e5b2bae0b4b3a3d81c85610b95cd4</Common:Simple_Hash_Value>
       </Common:Hash>
       <Common:Hash>
        <Common:Type datatype="String">SHA1</Common:Type>
        <Common:Simple_Hash_Value datatype="hexBinary">4484e08903744ceeaedd8f5e1bfc06b2c4688e76</Common:Simple_Hash_Value>
       </Common:Hash>
      </FileObj:Hashes>
     </cybox:Defined_Object>
   </maecPackage:Subject_Attributes>
   
   <maecPackage:Analyses>
    <maecPackage:Analysis id="maec-example-ana-1" method="Dynamic" type="Triage">
     <maecPackage:Summary>Dynamic (behavioral)  triage of the subject binary.</maecPackage:Summary>
     <maecPackage:Findings_Bundle_Reference bundle_idref="maec-example-bnd-1"/>
     <maecPackage:Tools>
      <maecPackage:Tool id="analysis-tool-1">
       <Common:Vendor>IsecLab</Common:Vendor>
       <Common:Name>Anubis</Common:Name>
      </maecPackage:Tool>
     </maecPackage:Tools>
    </maecPackage:Analysis>
    
    <maecPackage:Analysis id="maec-example-ana-2" method="Dynamic" type="Triage">
     <maecPackage:Summary>Dynamic (behavioral) and tool-based triage of the subject binary.</maecPackage:Summary>
     <maecPackage:Findings_Bundle_Reference bundle_idref="maec-example-bnd-2"/>
     <maecPackage:Tools>
      <maecPackage:Tool id="analysis-tool-2">
       <Common:Vendor>Symantec</Common:Vendor>
       <Common:Name>ThreatExpert</Common:Name>
      </maecPackage:Tool>
     </maecPackage:Tools>
    </maecPackage:Analysis>
   </maecPackage:Analyses>
   
   <maecPackage:Findings_Bundles>
    <maecPackage:Bundle id="maec-example-bnd-1" schema_version="3.0" defined_subject="false" content_type="dynamic_analysis_tool_output">
        <maecBundle:Collections>
             <maecBundle:Action_Collections>
                 <maecBundle:Action_Collection name="File System Actions" id="maec-anubis_to_maec-actc-1">
                     <maecBundle:Action_List>
                         <maecBundle:Action action_status="Success" context="Host" type="Create" name="Create File" id="maec-anubis_to_maec-act-1">
                             <cybox:Associated_Objects>
                                 <cybox:Associated_Object type="File" id="maec-anubis_to_maec-obj-1" association_type="Affected">
                                     <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
                                         <FileObj:File_Name datatype="String">oembios.exe</FileObj:File_Name>
                                         <FileObj:File_Path datatype="String">C:\WINDOWS\system32\</FileObj:File_Path>
                                     </cybox:Defined_Object>
                                 </cybox:Associated_Object>
                             </cybox:Associated_Objects>
                         </maecBundle:Action>
                     </maecBundle:Action_List>
                 </maecBundle:Action_Collection>
              
                 <maecBundle:Action_Collection name="IPC Actions" id="maec-anubis_to_maec-actc-2">
                     <maecBundle:Action_List>
                         <maecBundle:Action action_status="Success" context="Host" type="Create" name="Create Mutex" id="maec-anubis_to_maec-act-2">
                             <cybox:Associated_Objects>
                                 <cybox:Associated_Object type="Mutex" id="maec-anubis_to_maec-obj-2" association_type="Affected">
                                     <cybox:Defined_Object xsi:type="WinMutexObj:WindowsMutexObjectType" named="true">
                                         <MutexObj:Name datatype="String">__SYSTEM__91C38905__</MutexObj:Name>
                                     </cybox:Defined_Object>
                                 </cybox:Associated_Object>           
                             </cybox:Associated_Objects>
                         </maecBundle:Action>
                     </maecBundle:Action_List>
                 </maecBundle:Action_Collection>
              
                 <maecBundle:Action_Collection name="Registry Actions" id="maec-anubis_to_maec-actc-3">
                     <maecBundle:Action_List>
                         <maecBundle:Action action_status="Success" context="Host" type="Modify" name="Write Registry Key Value" id="maec-anubis_to_maec-act-3">
                             <cybox:Associated_Objects>
                                 <cybox:Associated_Object type="Registry Key/Key Group" id="maec-anubis_to_maec-obj-3" association_type="Affected">
                                     <cybox:Defined_Object xsi:type="WinRegistryKeyObj:WindowsRegistryKeyObjectType">
                                         <WinRegistryKeyObj:Key datatype="String">software\microsoft\windows nt\currentversion\winlogon</WinRegistryKeyObj:Key>
                                         <WinRegistryKeyObj:Hive datatype="String">HKEY_LOCAL_MACHINE</WinRegistryKeyObj:Hive>
                                         <WinRegistryKeyObj:Values>
                                             <WinRegistryKeyObj:Value>
                                                 <WinRegistryKeyObj:Name datatype="String">userinit</WinRegistryKeyObj:Name>
                                                 <WinRegistryKeyObj:Data datatype="String">C:\WINDOWS\system32\userinit.exe,C:\WINDOWS\system32\oembios.exe,</WinRegistryKeyObj:Data>
                                             </WinRegistryKeyObj:Value>
                                         </WinRegistryKeyObj:Values>
                                     </cybox:Defined_Object>
                                 </cybox:Associated_Object>
                             </cybox:Associated_Objects>
                         </maecBundle:Action>
                     </maecBundle:Action_List>
                 </maecBundle:Action_Collection>
             </maecBundle:Action_Collections>
         </maecBundle:Collections>
    </maecPackage:Bundle>
    
       <maecPackage:Bundle id="maec-example-bnd-2" schema_version="3.0" defined_subject="false" content_type="dynamic_analysis_tool_output">
        <maecBundle:Collections>
            <maecBundle:Action_Collections>
                <maecBundle:Action_Collection name="File System Actions" id="maec-threatexpert_to_maec-actc-1">
                    <maecBundle:Action_List>
                        <maecBundle:Action action_status="Success" type="Create" name="Create File" id="maec-threatexpert_to_maec-act-1">
                            <cybox:Associated_Objects>
                                <cybox:Associated_Object type="File" id="maec-threatexpert_to_maec-obj-1">
                                    <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
                                        <FileObj:File_Name datatype="String">sysproc32.sys</FileObj:File_Name>
                                        <FileObj:File_Path datatype="String">%Profiles%\LocalService\Application Data\sysproc64\</FileObj:File_Path>
                                        <FileObj:Hashes>
                                            <Common:Hash>
                                                <Common:Type datatype="String">SHA1</Common:Type>
                                                <Common:Simple_Hash_Value datatype="hexBinary">1BF78B02A09E11414C2DFF3C4FF7DFA282A4125E</Common:Simple_Hash_Value>
                                            </Common:Hash>
                                            <Common:Hash>
                                                <Common:Type datatype="String">MD5</Common:Type>
                                                <Common:Simple_Hash_Value datatype="hexBinary">9855B3C1D06770B46927917F89C7FAEE</Common:Simple_Hash_Value>
                                            </Common:Hash>
                                        </FileObj:Hashes>
                                    </cybox:Defined_Object>
                                </cybox:Associated_Object>
                            </cybox:Associated_Objects>
                        </maecBundle:Action>
                    </maecBundle:Action_List>
                </maecBundle:Action_Collection>
             
                <maecBundle:Action_Collection name="IPC Actions" id="maec-threatexpert_to_maec-actc-2">
                    <maecBundle:Action_List>
                        <maecBundle:Action action_status="Success" type="Create" name="Create Mutex" id="maec-threatexpert_to_maec-act-2" context="Host">
                            <cybox:Associated_Objects>
                                <cybox:Associated_Object type="Mutex" id="maec-threatexpert_to_maec-obj-2">
                                    <cybox:Defined_Object xsi:type="WinMutexObj:WindowsMutexObjectType" named="true">
                                        <MutexObj:Name datatype="String">__SYSTEM__91C38905__</MutexObj:Name>
                                    </cybox:Defined_Object>
                                </cybox:Associated_Object>
                            </cybox:Associated_Objects>
                        </maecBundle:Action>
                    </maecBundle:Action_List>
                 
                </maecBundle:Action_Collection>
                <maecBundle:Action_Collection name="Registry Actions" id="maec-threatexpert_to_maec-actc-3">
                    <maecBundle:Action_List>
                        <maecBundle:Action action_status="Success" type="Create" name="Create Registry Key" id="maec-threatexpert_to_maec-act-3" context="Host">
                            <cybox:Associated_Objects>
                                <cybox:Associated_Object type="Registry Key/Key Group" id="maec-threatexpert_to_maec-obj-3">
                                    <cybox:Defined_Object xsi:type="WinRegistryKeyObj:WindowsRegistryKeyObjectType">
                                        <WinRegistryKeyObj:Key datatype="String">.DEFAULT\Software\Microsoft\Windows\CurrentVersion\Explorer\{19127AD2-394B-70F5-C650-B97867BAA1F7}</WinRegistryKeyObj:Key>
                                        <WinRegistryKeyObj:Hive datatype="String">HKEY_USERS</WinRegistryKeyObj:Hive>
                                    </cybox:Defined_Object>
                                </cybox:Associated_Object>
                            </cybox:Associated_Objects>
                        </maecBundle:Action>
                    </maecBundle:Action_List>
                </maecBundle:Action_Collection>
            </maecBundle:Action_Collections>
        </maecBundle:Collections>
    </maecPackage:Bundle>
   </maecPackage:Findings_Bundles>
  </maecPackage:Malware_Subject>
 </maecPackage:Malware_Subjects>
</maecPackage:MAEC_Package>
