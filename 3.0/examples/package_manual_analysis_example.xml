<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Dynamic Triage Analysis Example
 
 Based on SANS Reading Room Paper: A Detailed Analysis of an Advanced Persistent Threat Malware, by Frankie Li 
 http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814
 
 This example builds upon the static triage example (http://maec.mitre.org/language/version2.1/static_triage_example.xml)
 
 Action Associated Objects that are used more than once (e.g. in multiple actions) are stored inside the <Objects> 
 Bundle element and then referenced with the idref attribute.
 
 Updated October 2012 for MAEC v3.0 and CybOX v1.0 draft-->
<maecPackage:MAEC_Packages
 xmlns:cybox="http://cybox.mitre.org/cybox_v1"
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-3"
 xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-3"
 xmlns:mmdef="http://xml/metadataSharing.xsd"
 xmlns:common="http://cybox.mitre.org/Common_v1"
 xmlns:AddressObj="http://cybox.mitre.org/objects#AddressObject"
 xmlns:ProcessObj="http://cybox.mitre.org/objects#ProcessObject"
 xmlns:WinProcessObj="http://cybox.mitre.org/objects#WinProcessObject"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject"
 xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject"
 xmlns:MutexObj="http://cybox.mitre.org/objects#MutexObject"
 xmlns:WinMutexObj="http://cybox.mitre.org/objects#WinMutexObject"
 xmlns:URIObj="http://cybox.mitre.org/objects#URIObject"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-package-3 ../maec-package-schema.xsd http://maec.mitre.org/XMLSchema/maec-bundle-3 ../maec-bundle-schema.xsd 
 http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/Win_Executable_File_Object_1.2.xsd
 http://cybox.mitre.org/objects#WinMutexObject http://cybox.mitre.org/XMLSchema/objects/Win_Mutex/Win_Mutex_Object_1.1.xsd 
 http://cybox.mitre.org/objects#WinProcessObject http://cybox.mitre.org/XMLSchema/objects/Win_Process/Win_Process_Object_1.2.xsd 
 http://cybox.mitre.org/objects#URIObject http://cybox.mitre.org/XMLSchema/objects/URI/URI_Object_1.1.xsd">

<maecPackage:Package id="maec-tst-pkg-1" schema_version="1.0">
 <maecPackage:Malware_Subjects>
  <maecPackage:Malware_Subject id="maec-tst-sub-1">
   <maecPackage:Subject_Attributes>
     <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
      <FileObj:File_Name datatype="String" condition="Equals">dg003_improve_8080_V132.exe</FileObj:File_Name>
      <FileObj:Size_In_Bytes datatype="UnsignedLong" condition="Equals">196608</FileObj:Size_In_Bytes>
      <FileObj:Hashes>
       <common:Hash>
        <common:Type datatype="String" condition="Equals">MD5</common:Type>
        <common:Simple_Hash_Value datatype="hexBinary" condition="Equals">4EC0027BEF4D7E1786A04D021FA8A67F</common:Simple_Hash_Value>
       </common:Hash>
      </FileObj:Hashes>
     </cybox:Defined_Object>
   </maecPackage:Subject_Attributes>
   
   <maecPackage:Analyses>
    <maecPackage:Analysis id="maec-example-ana-1" method="Static" type="Triage">
     <maecPackage:Source>
      <maecPackage:Name>Frankie Li</maecPackage:Name>
      <maecPackage:URL>
       <URIObj:Value datatype="AnyURI" condition="Equals">http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814</URIObj:Value>
      </maecPackage:URL>
     </maecPackage:Source>
     <maecPackage:Summary>A basic static triage of the subject binary using PEiD.</maecPackage:Summary>
     <maecPackage:Findings_Bundle_Reference bundle_idref="maec-example-bnd-1"/>
     <maecPackage:Tools>
      <maecPackage:Tool id="analysis-tool-1">
       <common:Name>PEiD</common:Name>
       <common:Version>0.94</common:Version>
      </maecPackage:Tool>
     </maecPackage:Tools>
    </maecPackage:Analysis>
    
    <maecPackage:Analysis id="maec-example-ana-2" method="Dynamic" type="Triage">
     <maecPackage:Source>
      <maecPackage:Name>Frankie Li</maecPackage:Name>
      <maecPackage:URL>
       <URIObj:Value datatype="AnyURI" condition="Equals">http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814</URIObj:Value>
      </maecPackage:URL>
     </maecPackage:Source>
     <maecPackage:Summary>Dynamic (behavioral) and tool-based triage of the subject
      binary.</maecPackage:Summary>
     <maecPackage:Findings_Bundle_Reference bundle_idref="maec-example-bnd-2"/>
     <maecPackage:Tools>
      <maecPackage:Tool id="analysis-tool-2">
       <common:Vendor>Zealand Honeynet Project</common:Vendor>
       <common:Name>CaptureBAT</common:Name>
       <common:Version>2.0.0</common:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-3">
       <common:Name>Regshot</common:Name>
       <common:Version>v1.8.2</common:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-4">
       <common:Name>HandleDiff</common:Name>
       <common:Version>v.0.2</common:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-5">
       <common:Vendor>Sysinternals</common:Vendor>
       <common:Name>VMMap</common:Name>
       <common:Version>3.1</common:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-6">
       <common:Vendor>Wireshark.org</common:Vendor>
       <common:Name>Wireshark</common:Name>
       <common:Version>1.2.2</common:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-7">
       <common:Vendor>Sysinternals</common:Vendor>
       <common:Name>Process Monitor</common:Name>
       <common:Version>15.0</common:Version>
      </maecPackage:Tool>
     </maecPackage:Tools>
    </maecPackage:Analysis>
   </maecPackage:Analyses>
   
   <maecPackage:Findings_Bundles>
    <maecPackage:Bundle id="maec-example-bnd-1" schema_version="3.0" defined_subject="false" content_type="extracted_from_subject">
     <maecBundle:Objects>
      <maecBundle:Object id="maec-example-obj-1" type="File">
        <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
         <WinExecFileObj:PE_Attributes>
          <WinExecFileObj:Base_Address datatype="hexBinary" condition="Equals">036418</WinExecFileObj:Base_Address>
          <WinExecFileObj:Headers>
           <WinExecFileObj:Optional_Header>
            <WinExecFileObj:Major_Linker_Version datatype="hexBinary" condition="Equals">06</WinExecFileObj:Major_Linker_Version>
            <WinExecFileObj:Minor_Linker_Version datatype="hexBinary" condition="Equals">00</WinExecFileObj:Minor_Linker_Version>
           </WinExecFileObj:Optional_Header>
          </WinExecFileObj:Headers>
          <WinExecFileObj:Subsystem datatype="String" condition="Equals">Windows_GUI</WinExecFileObj:Subsystem>
          <WinExecFileObj:Type datatype="String" condition="Equals">Executable</WinExecFileObj:Type>
         </WinExecFileObj:PE_Attributes>
        </cybox:Defined_Object>
       </maecBundle:Object>
     </maecBundle:Objects>
    </maecPackage:Bundle>
    
    <maecPackage:Bundle id="maec-example-bnd-2" schema_version="3.0" defined_subject="false" content_type="dynamic_analysis_output">
     <maecBundle:Process_Tree>
      <maecBundle:Root_Process id="maec-example-pro-1">
       <ProcessObj:Image_Info>
        <ProcessObj:Path>dg003.exe</ProcessObj:Path>
       </ProcessObj:Image_Info>
       <maecBundle:Initiated_Actions>
        <maecBundle:Action_Reference action_id="maec-example-act-1"/>
        <maecBundle:Action_Reference action_id="maec-example-act-2"/>
        <maecBundle:Action_Reference action_id="maec-example-act-3"/>
        <maecBundle:Action_Reference action_id="maec-example-act-4"/>
        <maecBundle:Action_Reference action_id="maec-example-act-5"/>
       </maecBundle:Initiated_Actions>
       <maecBundle:Injected_Process id="maec-example-pro-2" parent_action_idref="maec-example-act-10">
        <ProcessObj:Image_Info>
         <ProcessObj:Path>explorer.exe</ProcessObj:Path>
        </ProcessObj:Image_Info>
        <maecBundle:Initiated_Actions>
         <maecBundle:Action_Reference action_id="maec-example-act-6"/>
         <maecBundle:Action_Reference action_id="maec-example-act-7"/>
         <maecBundle:Action_Reference action_id="maec-example-act-9"/>
         <maecBundle:Action_Reference action_id="maec-example-act-18"/>
         <maecBundle:Action_Reference action_id="maec-example-act-19"/>
         <maecBundle:Action_Reference action_id="maec-example-act-20"/>
         <maecBundle:Action_Reference action_id="maec-example-act-21"/>
         <maecBundle:Action_Reference action_id="maec-example-act-22"/>
         <maecBundle:Action_Reference action_id="maec-example-act-23"/>
         <maecBundle:Action_Reference action_id="maec-example-act-24"/>
         <maecBundle:Action_Reference action_id="maec-example-act-25"/>
        </maecBundle:Initiated_Actions>
        <maecBundle:Spawned_Process id="maec-example-pro-3" parent_action_idref="maec-example-act-21">
         <ProcessObj:Image_Info>
          <ProcessObj:Path>fvcwin32.exe</ProcessObj:Path>
         </ProcessObj:Image_Info>
        </maecBundle:Spawned_Process>
        <maecBundle:Spawned_Process id="maec-example-pro-4" parent_action_idref="maec-example-act-22">
         <ProcessObj:Image_Info>
          <ProcessObj:Path>acvcwin32.exe</ProcessObj:Path>
         </ProcessObj:Image_Info>
        </maecBundle:Spawned_Process>
        <maecBundle:Spawned_Process id="maec-example-pro-5" parent_action_idref="maec-example-act-10">
         <ProcessObj:Image_Info>
          <ProcessObj:Path>avcwin32.exe</ProcessObj:Path>
         </ProcessObj:Image_Info>
         <maecBundle:Initiated_Actions>
          <maecBundle:Action_Reference action_id="maec-example-act-26"/>
          <maecBundle:Action_Reference action_id="maec-example-act-27"/>
          <maecBundle:Action_Reference action_id="maec-example-act-28"/>
          <maecBundle:Action_Reference action_id="maec-example-act-29"/>
         </maecBundle:Initiated_Actions>
        </maecBundle:Spawned_Process>
       </maecBundle:Injected_Process>
      </maecBundle:Root_Process>
     </maecBundle:Process_Tree>
     
     <maecBundle:Actions>
       <maecBundle:Action id="maec-example-act-1" type="Create" name="Create File" context="Host" action_status="Success">
        <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-3" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">ws2help.PNF</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="FitsPattern" pattern_type="Regex" regex_syntax="PCRE">^C:\\Documents and Settings\\\s+user\s+\\Local
            Settings\\Application\\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
      </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-2" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
          <common:Tools>
           <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-4" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">msvcr.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="FitsPattern" pattern_type="Regex" regex_syntax="PCRE">^C:\\Documents and Settings\\\s+user\s+\\Local
            Settings\\Application\\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-3" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-5" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">1.txt</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\Windows\inf</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
         </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-4" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-6" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">netstat.exe</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\Windows\system32</FileObj:Full_Path>
          </cybox:Defined_Object>
          <cybox:Related_Objects>
           <cybox:Related_Object idref="maec-example-obj-8" relationship="Injected_Into">
            <cybox:Defined_Object xsi:type="WinProcessObj:WindowsProcessObjectType">
             <ProcessObj:Image_Info>
              <ProcessObj:Command_Line datatype="String">explorer.exe</ProcessObj:Command_Line>
              <ProcessObj:Path datatype="String">C:\Windows\</ProcessObj:Path>
             </ProcessObj:Image_Info>
            </cybox:Defined_Object>
           </cybox:Related_Object>
          </cybox:Related_Objects>
         </cybox:Associated_Object>
         </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-5" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-7" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">IECheck.exe</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="FitsPattern" pattern_type="Regex" regex_syntax="PCRE">^C:\\Documents and Settings\\\s+user\s+\\Local
            Settings\\Application\\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-6" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-9" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">IPsecstap.dat</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\Windows\system32</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-7" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-10" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">Internet Explorer Security Check.lnk</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="FitsPattern" pattern_type="Regex" regex_syntax="PCRE">^C:\\Documents and Settings\\\s+user\s+\\Start
            Menu\\Programs\\Startup</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
         </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-8" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-3"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-11" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">13605</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\Windows\system32</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-9" type="Create" name="Create Mutex" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-4"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-12" type="Mutex" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinMutexObj:WindowsMutexObjectType">
           <MutexObj:Name datatype="String" condition="Contains">VistaDLLProRUNNING</MutexObj:Name>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-10" type="Write" name="Write to Process Virtual Memory" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-5"/>
         </common:Tools>
         </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object idref="maec-example-obj-4" association_type="Utilized">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">msvcr.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="FitsPattern" pattern_type="Regex" regex_syntax="PCRE">^C:\\Documents and Settings\\\s+user\s+\\Local
            Settings\\Application\\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
         <cybox:Associated_Object id="maec-example-obj-8" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinProcessObj:WindowsProcessObjectType">
           <ProcessObj:Image_Info>
            <ProcessObj:Command_Line datatype="String">explorer.exe</ProcessObj:Command_Line>
            <ProcessObj:Path datatype="String">C:\Windows\</ProcessObj:Path>
           </ProcessObj:Image_Info>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
        <cybox:Relationships>
         <cybox:Relationship type="Preceded_By">
          <cybox:Action_Reference action_id="maec-example-act-2"/>
         </cybox:Relationship>
        </cybox:Relationships>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-11" type="Query" name="Query DNS" context="Network" network_protocol="DNS" action_status="Fail">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-6"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-13" type="URI" association_type="Utilized">
          <cybox:Defined_Object xsi:type="URIObj:URIObjectType">
           <URIObj:Value datatype="AnyURI" condition="Contains">test.3322.org.cn</URIObj:Value>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-12" type="Query" name="Query DNS" context="Network" network_protocol="DNS" action_status="Fail">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-6"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-14" type="URI" association_type="Utilized">
          <cybox:Defined_Object xsi:type="URIObj:URIObjectType">
           <URIObj:Value datatype="AnyURI" condition="Contains">1.test.3322.org.cn</URIObj:Value>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-13" type="Query" name="Query DNS" context="Network" network_protocol="DNS" action_status="Fail">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-6"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-15" type="URI" association_type="Utilized">
          <cybox:Defined_Object xsi:type="URIObj:URIObjectType">
           <URIObj:Value datatype="AnyURI" condition="Contains">2.test.3322.org.cn</URIObj:Value>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-14" type="Query" name="Query DNS" context="Network" network_protocol="DNS" action_status="Fail">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-6"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-16" type="URI" association_type="Utilized">
          <cybox:Defined_Object xsi:type="URIObj:URIObjectType">
           <URIObj:Value datatype="AnyURI" condition="Contains">3.test.3322.org.cn</URIObj:Value>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-15" type="Query" name="Query DNS" context="Network" network_protocol="DNS" action_status="Fail">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-6"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-17" type="URI" association_type="Utilized">
          <cybox:Defined_Object xsi:type="URIObj:URIObjectType">
           <URIObj:Value datatype="AnyURI" condition="Contains">4.test.3322.org.cn</URIObj:Value>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-16" type="Connect" name="Connect to IP" context="Network" network_protocol="TCP/IP" action_status="Fail">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-6"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-18" type="IP Address" association_type="Utilized">
          <cybox:Defined_Object xsi:type="AddressObj:AddressObjectType" category="ipv4-addr">
           <AddressObj:Address_Value datatype="String" condition="Equals">172.16.0.61</AddressObj:Address_Value>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-17" type="Connect" name="Connect to IP" context="Network" network_protocol="TCP/IP" action_status="Fail">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-6"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-19" type="IP Address" association_type="Utilized">
          <cybox:Defined_Object xsi:type="AddressObj:AddressObjectType" category="ipv4-addr">
           <AddressObj:Address_Value datatype="String" condition="FitsPattern" pattern_type="Regex" regex_syntax="PCRE">^115\..*\..*\.249</AddressObj:Address_Value>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-18" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-20" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">fvcwin32.exe</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-19" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-21" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">acvcwin32.exe</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-20" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-22" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">avcwin32.exe</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-21" type="Create" name="Create Process" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-7"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-23" type="Process" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinProcessObj:WindowsProcessObjectType">
           <ProcessObj:Image_Info>
            <ProcessObj:Command_Line datatype="String" condition="Equals">fvcwin32.exe</ProcessObj:Command_Line>
            <ProcessObj:Path datatype="String" condition="Equals">C:\WINDOWS\Debug</ProcessObj:Path>
           </ProcessObj:Image_Info>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-22" type="Create" name="Create Process" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-7"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-24" type="Process" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinProcessObj:WindowsProcessObjectType">
           <ProcessObj:Image_Info>
            <ProcessObj:Command_Line datatype="String" condition="Equals">acvcwin32.exe</ProcessObj:Command_Line>
            <ProcessObj:Path datatype="String" condition="Equals">C:\WINDOWS\Debug</ProcessObj:Path>
           </ProcessObj:Image_Info>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-23" type="Create" name="Create Process" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-7"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-25" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinProcessObj:WindowsProcessObjectType">
           <ProcessObj:Image_Info>
            <ProcessObj:Command_Line datatype="String">avcwin32.exe</ProcessObj:Command_Line>
            <ProcessObj:Path datatype="String">C:\WINDOWS\Debug</ProcessObj:Path>
           </ProcessObj:Image_Info>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-24" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-26" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">AutoList.txt</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="FitsPattern" pattern_type="Regex" regex_syntax="PCRE">^C:\\Documents and Settings\\.*\\Application
            Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-25" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-27" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">AutoList.txt</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="FitsPattern" pattern_type="Regex" regex_syntax="PCRE">^C:\\Documents and Settings\\.*\\Application
            Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-26" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-28" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">SAM.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-27" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-29" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">system.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-28" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-30" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">system.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
      <maecBundle:Action id="maec-example-act-29" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-31" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">Iestorage.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
      <maecBundle:Action id="maec-example-act-30" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-32" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">SAM.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
      <maecBundle:Action id="maec-example-act-31" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-33" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">system.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
      <maecBundle:Action id="maec-example-act-32" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-34" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">iestorage.dll</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-33" type="Create" name="Create File" context="Host" action_status="Success">
         <cybox:Discovery_Method source_type="Tool">
         <common:Tools>
          <common:Tool idref="analysis-tool-2"/>
         </common:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-35" type="File" association_type="Affected">
          <cybox:Defined_Object xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name datatype="String" condition="Equals">drive.cab</FileObj:File_Name>
           <FileObj:Full_Path datatype="String" condition="Equals">C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Defined_Object>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
      </maecBundle:Actions>
    </maecPackage:Bundle>
   </maecPackage:Findings_Bundles>
  </maecPackage:Malware_Subject>
 </maecPackage:Malware_Subjects>
</maecPackage:Package>
</maecPackage:MAEC_Packages>
