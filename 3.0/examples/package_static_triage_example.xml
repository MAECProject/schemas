<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Static Triage Analysis Example
 
 Based on SANS Reading Room Paper: A Detailed Analysis of an Advanced Persistent Threat Malware, by Frankie Li 
 http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814
 
 Updated November 2012 for MAEC v3.0 and CybOX v1.0 final-->
<maecPackage:MAEC_Package
 xmlns:cybox="http://cybox.mitre.org/cybox_v1"
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-1"
 xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-3"
 xmlns:common="http://cybox.mitre.org/Common_v1"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject"
 xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-package-3 ../maec-package-schema.xsd http://maec.mitre.org/XMLSchema/maec-bundle-3 ../maec-bundle-schema.xsd 
 http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/Win_Executable_File_Object_1.2.xsd" id="maec-tst-pkg-1" schema_version="1.0">

 <maecPackage:Malware_Subjects>
  <maecPackage:Malware_Subject id="maec-tst-sub-1">
   <maecPackage:Subject_Attributes>
     <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
      <FileObj:File_Name datatype="String" condition="Equals">dg003_improve_8080_V132.exe</FileObj:File_Name>
      <FileObj:Size_In_Bytes datatype="UnsignedLong" condition="Equals">196608</FileObj:Size_In_Bytes>
      <FileObj:Hashes>
       <common:Hash>
        <common:Type datatype="String" condition="Equals">MD5</common:Type>
        <common:Simple_Hash_Value datatype="hexBinary" condition="Equals">4EC0027BEF4D7E1786A04D021FA8A67F</common:Simple_Hash_Value>
       </common:Hash>
      </FileObj:Hashes>
      <FileObj:Packer_List>
       <FileObj:Packer>
        <FileObj:Name datatype="String">UPX</FileObj:Name>
        <FileObj:PEiD datatype="String">UPX v3.0.2</FileObj:PEiD>
       </FileObj:Packer>
      </FileObj:Packer_List>
     </cybox:Defined_Object>
   </maecPackage:Subject_Attributes>
   
   <maecPackage:Analyses>
    <maecPackage:Analysis id="maec-example-ana-1" method="Static" type="Triage">
     <maecPackage:Source>
      <maecPackage:Name>Frankie Li</maecPackage:Name>
      <maecPackage:URL>http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814</maecPackage:URL>
     </maecPackage:Source>
     <maecPackage:Summary>A basic static triage of the subject binary using PEiD.</maecPackage:Summary>
     <maecPackage:Findings_Bundle_Reference bundle_idref="maec-tst-bnd-1"/>
     <maecPackage:Tools>
      <maecPackage:Tool id="analysis-tool-1">
       <common:Name>PEiD</common:Name>
       <common:Version>0.94</common:Version>
      </maecPackage:Tool>
     </maecPackage:Tools>
    </maecPackage:Analysis>
   </maecPackage:Analyses>
   
   <maecPackage:Findings_Bundles>
    <maecPackage:Bundle id="maec-tst-bnd-1" schema_version="3.0" defined_subject="false" content_type="extracted_from_subject">
     <maecBundle:Objects>
      <maecBundle:Object id="maec-tst-obj-1" type="File">
        <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
         <WinExecFileObj:PE_Attributes>
          <WinExecFileObj:Base_Address datatype="hexBinary" condition="Equals">036418</WinExecFileObj:Base_Address>
          <WinExecFileObj:Headers>
           <WinExecFileObj:Optional_Header>
            <WinExecFileObj:Major_Linker_Version datatype="hexBinary" condition="Equals">06</WinExecFileObj:Major_Linker_Version>
            <WinExecFileObj:Minor_Linker_Version datatype="hexBinary" condition="Equals">00</WinExecFileObj:Minor_Linker_Version>
           </WinExecFileObj:Optional_Header>
          </WinExecFileObj:Headers>
          <WinExecFileObj:Subsystem datatype="String" condition="Equals">Windows_GUI</WinExecFileObj:Subsystem>
          <WinExecFileObj:Type datatype="String" condition="Equals">Executable</WinExecFileObj:Type>
         </WinExecFileObj:PE_Attributes>
        </cybox:Defined_Object>
       </maecBundle:Object>
     </maecBundle:Objects>
    </maecPackage:Bundle>
   </maecPackage:Findings_Bundles>
  </maecPackage:Malware_Subject>
 </maecPackage:Malware_Subjects>
</maecPackage:MAEC_Package>
