<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Package Multi-partite Malware Example
 -Demonstrates how multi-partite malware may be captured as unique Malware Subjects in a Package
 -Shows how the relationships between the multiple related Malware Subjects are constructed
 -Based on SANS Reading Room Paper: A Detailed Analysis of an Advanced Persistent Threat Malware, by Frankie Li. http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814
 
 Created November 2012 for MAEC v3.0 and CybOX v1.0 final-->
<maecPackage:MAEC_Package
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-1"
 xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-3"
 xmlns:cybox="http://cybox.mitre.org/cybox_v1"
 xmlns:Common="http://cybox.mitre.org/Common_v1"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject"
 xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-package-3 ../maec-package-schema.xsd 
 http://maec.mitre.org/XMLSchema/maec-bundle-3 ../maec-bundle-schema.xsd 
 http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/Win_Executable_File_Object_1.3.xsd" 
 id="maec-example-pkg-1" schema_version="1.0">

 <maecPackage:Malware_Subjects>
  <maecPackage:Malware_Subject id="maec-example-sub-1">
   <maecPackage:Subject_Attributes>
     <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
      <FileObj:File_Name datatype="String" condition="Equals">dg003_improve_8080_V132.exe</FileObj:File_Name>
      <FileObj:Size_In_Bytes datatype="UnsignedLong" condition="Equals">196608</FileObj:Size_In_Bytes>
      <FileObj:Hashes>
       <Common:Hash>
        <Common:Type datatype="String" condition="Equals">MD5</Common:Type>
        <Common:Simple_Hash_Value datatype="hexBinary" condition="Equals">4EC0027BEF4D7E1786A04D021FA8A67F</Common:Simple_Hash_Value>
       </Common:Hash>
      </FileObj:Hashes>
     </cybox:Defined_Object>
   </maecPackage:Subject_Attributes>
   <maecPackage:Relationships>
    <maecPackage:Relationship type="drops">
     <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-example-sub-2"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="maec-example-sub-2">
   <maecPackage:Subject_Attributes>
    <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name datatype="String" condition="Equals">msvcr.dll</FileObj:File_Name>
    </cybox:Defined_Object>
   </maecPackage:Subject_Attributes>
   <maecPackage:Relationships>
    <maecPackage:Relationship type="dropped_by">
     <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-example-sub-1"/>
    </maecPackage:Relationship>
    <maecPackage:Relationship type="downloads">
     <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-example-sub-3"/>
     <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-example-sub-4"/>
     <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-example-sub-5"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="maec-example-sub-3">
   <maecPackage:Subject_Attributes>
    <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name datatype="String" condition="Equals">fvcwin32.exe</FileObj:File_Name>
    </cybox:Defined_Object>
   </maecPackage:Subject_Attributes>
   <maecPackage:Relationships>
    <maecPackage:Relationship type="downloaded_by">
     <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-example-sub-2"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="maec-example-sub-4">
   <maecPackage:Subject_Attributes>
    <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name datatype="String" condition="Equals">acvcwin32.exe</FileObj:File_Name>
    </cybox:Defined_Object>
   </maecPackage:Subject_Attributes>
   <maecPackage:Relationships>
    <maecPackage:Relationship type="downloaded_by">
     <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-example-sub-2"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="maec-example-sub-5">
   <maecPackage:Subject_Attributes>
    <cybox:Defined_Object xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name datatype="String" condition="Equals">avcwin32.exe</FileObj:File_Name>
    </cybox:Defined_Object>
   </maecPackage:Subject_Attributes>
   <maecPackage:Relationships>
    <maecPackage:Relationship type="downloaded_by">
     <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-example-sub-2"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
 </maecPackage:Malware_Subjects>
 
 <maecPackage:Grouping_Relationships>
  <maecPackage:Grouping_Relationship type="observed_together"/>
 </maecPackage:Grouping_Relationships>
</maecPackage:MAEC_Package>
