{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "MalwareActionType": {
            "title": "MalwareAction",
            "type": "object",
            "description": "The MalwareActionType is one of the foundational MAEC types, and serves as a method for the characterization of actions found or observed in malware. Actions can be thought of as system state changes and similar operations that represent the fundamental low-level operation of malware. Some examples include the creation of a file, deletion of a registry key, and the sending of some  data on a socket.",
            "properties": {
                "type": {
                    "type": "string",
                    "enum": ["malware-action"]
                },
                "id": {
                    "type": "string",
                    "description": "The required id field specifies a unique id for this Malware Action."
                },
                "name": {
                    "type": "string",
                    "description": "The name field captures the name of Malware Action. The suggested vocabulary for use with this field is malware-action-ov."
                },
                "description": {
                    "type": "string",
                    "description": "The Description field contains a textual description of the Malware Action."
                },
                "input_object_refs": {
                    "type": "array",
                    "items": {"$ref": "string"},
                    "description": "An input_object_ref specifies a set of one or more CybOX Objects used as input to the Malware Action. The string will capture an identifier of type cybox:object-ref."
                },
                "output_object_refs": {
                    "type": "array",
                    "items": {"$ref": "string"},
                    "description": "An output_object_ref specifies a set of one or more CybOX Objects resulting as output from the Malware Action. The string will capture an identifier of type cybox:object-ref."
                },
                "implementation": {
                    "$ref": "#/definitions/ActionImplementationType",
                    "description": "The implementation field serves to capture attributes that are relevant to how the Malware Action is implemented, such as the specific API call that was used."
                },
                "timestamps": {
                    "type": "string",
                    "format": "date-time",
                    "description": "The timestamp field represents the local or relative time at which the action occurred or was observed. In order to avoid ambiguity, it is strongly suggest that all timestamps in this field include a specification of the timezone if it is known, via the timestamp_precision field."
                },
                "status": {
                    "type": "string",
                    "description": "The status field captures the status of the Malware Action, with respect to the success of its execution. The suggested vocabulary for use with this field is execution-status-ov."
                },
                "count": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "The count field captures how many times the Malware Action was observed, for cases where the same action is seen multiple times. In such cases, the timestamp field should be used to capture the first time the action was observed."
                }
            },
            "required": [
                "id",
                "type",
                "name"
            ]
        },
        "ActionImplementationType": {
            "title": "ActionImplementation",
            "type": "object",
            "description": "The ActionImplementationType serves as a method for the characterization of Action Implementations. Currently supported are implementations achieved through API function calls and abstractly defined code.",
            "properties": {
                "compatible_platforms": {
                    "type": "array",
                    "description": "The compatible_platforms field specifies the specific platform(s) that the Action is compatible with, in other words, capable of being successfully executed on.",
                    "items": {"$ref": "#/REFERENCE PLACEHOLDER FOR cyboxCommon:PlatformSpecificationType"}
                },
                "api_address":{
                    "type":"string",
                    "pattern":"*[0123456789ABCDEFabcdef]",
                    "description":"contains the hexidecimal address of the API call in the binary."
                },
                "api_return_value":{
                    "type":"string",
                    "description":"Contains the return value of the API call."
                },
                "api_parameters":{
                    "type":"object",
                    "properties":{},
                    "additionalProperties" : true
                },
                "api_function_name":{
                    "type":"string",
                    "description":"Contains the exact name of the API function called e.g. CreateFileEx"
                },
                "api_normalized_function_name": {
                    "type": "string",
                    "description": "Contains the normalized name of the API function called e.g. CreateFile.",
                }
            },
        }
    }
}