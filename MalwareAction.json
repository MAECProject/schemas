{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "MalwareActionType": {
            "type": "object",
            "description": "The MalwareActionType is one of the foundational MAEC types, and serves as a method for the characterization of actions found or observed in malware. Actions can be thought of as system state changes and similar operations that represent the fundamental low-level operation of malware. Some examples include the creation of a file, deletion of a registry key, and the sending of some  data on a socket.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "The required id field specifies a unique id for this Malware Action."
                },
                "name": {
                    "type": "string",
                    "description": "The name field captures the name of Malware Action. The default vocabulary for this field is the MalwareActionVocabulary from the MAEC Default Vocabularies schema"
                },
                "description": {
                    "type": "string",
                    "description": "The Description field contains a textual description of the Malware Action."
                },
                "object_references": {
                    "type": "array",
                    "items": {"$ref": "#/definitions/ActionObjectReferenceType"},
                    "description": "An object_reference captures a reference to a CybOX Object associated with the Malware Action, including those used as input into the Malware Action, resulting as output from the Malware Action, and resulting as a side effect from the Malware Action."
                },
                "implementation": {
                    "$ref": "#/definitions/ActionImplementationType",
                    "description": "The implementation field serves to capture attributes that are relevant to how the Malware Action is implemented, such as the specific API call that was used."
                },
                "timestamp": {
                    "type": "string",
                    "format": "date-time",
                    "description": "The timestamp field represents the local or relative time at which the action occurred or was observed. In order to avoid ambiguity, it is strongly suggest that all timestamps in this field include a specification of the timezone if it is known, via the timestamp_precision field."
                },
                "timestamp_precision": {
                    "$ref": "REFERENCE PLACEHOLDER FOR cyboxCommon:DateTimePrecisionEnum",
                    "description": "Represents the precision of the associated timestamp value. If omitted, the default is \"second\", meaning the timestamp is precise to the full field value. Digits in the timestamp that are required by the xs:dateTime datatype but are beyond the specified precision should be zeroed out."
                },
                "action_status": {
                    "$ref": "Vocabs.json#/definitions/execution-status-ov",
                    "description": "The action_status field captures the status of the Malware Action, with respect to the success of its execution."
                },
                "count": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "The count field captures how many times the Malware Action was observed, for cases where the same action is seen multiple times. In such cases, the timestamp field should be used to capture the first time the action was observed."
                }
            },
            "required": ["id"]
        },
        "ActionObjectReferenceType": {
            "type": "object",
            "description": "The ActionObjectReferenceType captures a reference to a CybOX Object associated with a Malware Action.",
            "properties": {
                "object_ref": {
                    "type": "string",
                    "description": "The object_ref field serves as a reference to an existing CybOX Object in the MAEC document, via its ID."
                },
                "association_type": {"$ref": "Vocabs.json#/definitions/action-object-association-cv"}
            },
            "required": [
                "object_ref",
                "association_type"
            ]
        },
        "ActionImplementationType": {
            "type": "object",
            "description": "The ActionImplementationType serves as a method for the characterization of Action Implementations. Currently supported are implementations achieved through API function calls and abstractly defined code.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "The id field specifies a unique ID for this action Implementation"
                },
                "type": {"$ref": "Vocabs.json#/definitions/action-implementation-ov"},
                "compatible_platforms": {
                    "type": "array",
                    "description": "The compatible_platforms field specifies the specific platform(s) that the Action is compatible with, in other words, capable of being successfully executed on.",
                    "items": {"$ref": "#/REFERENCE PLACEHOLDER FOR cyboxCommon:PlatformSpecificationType"}
                },
                "api_call_or_code": {
                    "type": "object",
                    "description": "This field is for either an APICallType or and Object ID reference(code) ",
                    "oneOf": [
                        {"$ref": "#/definitions/APICallType"},
                        {
                            "type": "string",
                            "description": "The object_idref field specifies the id of the CybOX Object being referenced, where the object is a Code object that was used to implement the action"
                        }
                    ]
                }
            },
            "required": ["id"]
        },
        "APICallType": {
            "type": "object",
            "description": "The APICallType provides a method for the  characterization of API calls, including functions and their parameters.",
            "properties": {
                "address": {
                    "type": "string",
                    "pattern": "^[123456789abcdefABCDEF]*$",
                    "description": "The Address field contains the address of the API call in the binary(in hex encoded binary)."
                },
                "return_Value": {
                    "type": "string",
                    "description": "The Return_Value field contains the return value of the API call."
                },
                "parameters": {
                    "description": "Captures a list of function parameters",
                    "type": "array",
                    "items": {"$ref": "#/definitions/ParameterType"}
                },
                "function_name": {
                    "type": "string",
                    "description": "The function_name field contains the exact name of the API function called, e.g. CreateFileEx."
                },
                "normalized_function_name": {
                    "type": "string",
                    "description": "The normalized_function_name field contains the normalized name of the API function called, e.g. CreateFile."
                }
            }
        },
        "ParameterType": {
            "type": "object",
            "description": "The ParameterType characterizes function parameters.",
            "properties": {
                "ordinal_position": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "This field refers to the ordinal position of the parameter with respect to the function where it is used."
                },
                "name": {
                    "type": "string",
                    "description": "The name field specifies the name of the parameter"
                },
                "value": {
                    "type": "string",
                    "description": "The value field specifies the actual value of the parameter"
                }
            }
        }
    }
}