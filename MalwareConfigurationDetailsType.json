{
	"$schema": "http://json-schema.org/draft-04/schema#",
	"definitions":{
		"MalwareConfigurationDetailsType": {
			"type":"object",
			"description":"The MalwareConfigurationDetailsType captures details of malware configuation parameters and associated metadata",
			"properties":{
				"storage":{"$ref":"#/definitions/MalwareConfigurationStorageDetailsType","description":"The storage field captures the details of how the malware configuration parameters may be stored, e.g. in a seperate file, in memory, etc."},
				"obfuscation":{"$ref":"#/definitions/MalwareConfigurationObfuscationDetailsType","description":"The obfuscation field captures details of how the malware configuration parameters may be obfuscated, if applicable."},
				"configuration_parameter":{"$ref":"#/definitions/MalwareConfigurationParameterType","description":"The configuration_parameter field captures a single configuration parameter that may be defined for the malware subject. More than one configuration parameter may be specified by using multiple occurences of this field."}
			}
		},
		"MalwareConfigurationStorageDetailsType":{
			"type":"object",
			"description":"The MalwareConfigurationStorageDetailsType captures details relating to the storage of malware configuration parameters",
			"properties":{
				"malware_binary":{"$ref":"#/definitions/MalwareBinaryConfigurationStorageDetailsType", "description":"The malware_binary field that captures properties related to the storage of malware configuration parameters inside the malware binary captured in the Malware_Instance_Object_Attributes field."},
				"file":{"$ref":"#/definitions/ObjectReferenceType", "description":"The file field references a configuration file for cases where the Malware Subject stores its configuration parameters in a seperate file. The field MUST reference a File Object, which will use the FileObjectType from the imported CybOX File Object."},
				"url":{"type":"string", "format":"uri", "description":"The url field references URL at which the configuration parameters for the Malware Subject may be stored. More than one such URL may be references by using multiple occurences of this field. The field MUST reference a URI object, which will use the URIObjectType from the import CybOX URI Object."}
			}
		},
		"MalwareBinaryConfigurationStorageDetailsType":{
			"type":"object",
			"description":"The MalwareBinaryConfigurationStorageDetailsType captures details relating to the storage of malware configuration parameters inside the malware binary itself",
			"properties":{
				"file_offset":{"type":"string","pattern":"^[123456789abcdefABCDEF]$","description":"The file_offset field specifies the offset to the start of the malware configuration parameters in the malware binary."},
				"section_name":{"type":"string","description":"The section_name field specifies the offset in the PE section in the malware binary that contains the malware configuration parameters, for PE file malware binaries."},
				"section_offset":{"type":"string", "pattern":"^[123456789abcdefABCDEF]$", "description": "The section_offset field specifies the offset in the PE section in the malware binary that contains the malware configuration parameters to the start of the parameters themselves, for PE file malware binaries."}	
			}
		},
		"MalwareConfigurationObfuscationDetailsType":{
			"type":"object",
			"description":"The MalwareConfigurationObfuscationDetailsType captures details relating to the obfuscation of malware configuration parameters.",
			"properties":{
				"algorithm_details":{"$ref":"#/definitions/MalwareConfigurationObfuscationAlgorithmType","description":"The algorithm_details field captures the details of the algorithm used to encode or encrypt the malware configuration parameters, including the name of the algorithm and its key. More than one encryption or encoding algorithm may be specified by using multiple occurences of this field."},
				"is_encoded":{"type":"boolean","description":"The is_encoded field specifies that the malware configuration parameters are encoded with the algorithm captured in the algorithm_details field."},
				"is_encrypted":{"type":"boolean", "description":"The is_encrypted field specifies that the malware configuration parameters are encrypted with the algorithm captured in the algorithm_details field."}
			}
		},
		"MalwareConfigurationObfuscationAlgorithmType":{
			"type":"object",
			"description":"The MalwareConfigurationObfuscationAlgorithmType captures the details of an algorithm used to encode or encrypt malware configuration parameters",
			"properties":{
				"key":{"type":"string","pattern":"^[123456789abcdefABCDEF]$","description":"The key field captures the hexadecimal key used to decrypt the configuration parameters."},
				"algorithm_name":{"type":"string", "description":"The algorithm_name field captures the name of the encoding or encryption algorithm used to obfuscate the malware configuration parameters."},
				"ordinal_position":{"type":"integer", "minimum":0,"description":"The ordinal_position field specifies the explicit ordering of the usage of the algorithm with respect to the other algorithms used to encrypt or encode the malware configuration parameters, for cases where more than one algorithm was used."}
			}
		},
		"MalwareConfigurationParameterType":{
			"type":"object",
			"description":"The MalwareConfigurationParameterType captures a single configuration parameter that may be defined for a malware instance, as a name/value pair",
			"properties":{
				"name":{"type" : "string", "description" : "The name field specifies the name of the malware configuration parameter. It uses the MalwareConfigurationParameterVocab vocabulary from the MAEC Default Vocabularies schemas as its default vocabulary. Parameters that are not included in this vocabulary may also be specified, in which case it is recommended to use the exact name of the parameter."},
				"value":{"type":"string", "description" : "The value field captures the value of the malware configuration parameter."}
			}
		}
	}
}

		