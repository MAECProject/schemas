{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "MalwareConfigurationDetailsType": {
            "title":"MalwareConfigurationDetails",
	    "type": "object",
            "description": "The MalwareConfigurationDetailsType captures details of malware configuation parameters and associated metadata",
            "properties": {
                "storage": {
                    "$ref": "#/definitions/MalwareConfigurationStorageDetailsType",
                    "description": "The storage field captures the details of how the malware configuration parameters may be stored, e.g. in a separate file, in memory, etc."
                },
                "obfuscation": {
                    "$ref": "#/definitions/MalwareConfigurationObfuscationDetailsType",
                    "description": "The obfuscation field captures details of how the malware configuration parameters may be obfuscated, if applicable."
                },
                "configuration_parameters": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/MalwareConfigurationParameterType",
                        "description": "The configuration_parameter field captures a single configuration parameter that may be defined for the malware instance."
                    }
                }
            }
        },
        "MalwareConfigurationStorageDetailsType": {
	    "title":"MalwareConfigurationsStorageDetails",
            "type": "object",
            "description": "The MalwareConfigurationStorageDetailsType captures details relating to the storage of malware configuration parameters",
            "properties": {
                "malware_binary": {
                    "$ref": "#/definitions/MalwareBinaryConfigurationStorageDetailsType",
                    "description": "The malware_binary field that captures properties related to the storage of malware configuration parameters inside the malware binary captured in the Malware_Instance_Object_Attributes field."
                },
                "file_ref": {
                    "type": "string",
                    "description": "The file_ref field references a configuration file for cases where the Malware Subject stores its configuration parameters in a separate file. The field MUST reference a Software Object (via an ID) found in the cybox field at the top-level of the Package."
                },
                "url_refs": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "format": "uri",
                        "description": "The url field references one or more URLs at which the configuration parameters for the Malware Instance may be stored."
                    }
                }
            }
        },
        "MalwareBinaryConfigurationStorageDetailsType": {
	    "title":"MalwareBinaryConfigurationsStorageDetails",
            "type": "object",
            "description": "The MalwareBinaryConfigurationStorageDetailsType captures details relating to the storage of malware configuration parameters inside a malware binary.",
            "properties": {
                "file_offset": {
                    "type": "string",
                    "pattern": "*[0123456789abcdefABCDEF]",
                    "description": "The file_offset field specifies the offset to the start of the malware configuration parameters in the malware binary."
                },
                "section_name": {
                    "type": "string",
                    "description": "The section_name field specifies name of the PE section in the malware binary that contains the malware configuration parameters (for PE file malware binaries)."
                },
                "section_offset": {
                    "type": "string",
                    "pattern": "*[0123456789abcdefABCDEF]",
                    "description": "The section_offset field specifies the offset in the PE section in the malware binary that contains the malware configuration parameters to the start of the parameters themselves (for PE file malware binaries)."
                }
            }
        },
        "MalwareConfigurationObfuscationDetailsType": {
	    "title":"MalwareConfigurationObfuscationDetails",
            "type": "object",
            "description": "The MalwareConfigurationObfuscationDetailsType captures details relating to the obfuscation of malware configuration parameters.",
            "properties": {
                "algorithm_details": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/MalwareConfigurationObfuscationAlgorithmType",
                        "description": "The algorithm_details field captures the details of the algorithm used to encode or encrypt the malware configuration parameters, including the name of the algorithm and its key."
                    }
                },
                "is_encoded": {
                    "type": "boolean",
                    "description": "The is_encoded field specifies whether the malware configuration parameters are encoded with the algorithm captured in the algorithm_details field."
                },
                "is_encrypted": {
                    "type": "boolean",
                    "description": "The is_encrypted field specifies whether the malware configuration parameters are encrypted with the algorithm captured in the algorithm_details field."
                }
            }
        },
        "MalwareConfigurationObfuscationAlgorithmType": {
	    "title":"MalwareConfigurationsObfuscationAlgorithm",
            "type": "object",
            "description": "The MalwareConfigurationObfuscationAlgorithmType captures the details of an algorithm used to encode or encrypt malware configuration parameters",
            "properties": {
                "key": {
                    "type": "string",
                    "pattern": "*[0123456789abcdefABCDEF]",
                    "description": "The key field captures the hexadecimal key used to decrypt the configuration parameters."
                },
                "algorithm_name": {
                    "type": "string",
                    "description": "The algorithm_name field captures the name of the encoding or encryption algorithm used to obfuscate the malware configuration parameters."
                },
                "ordinal_position": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "The ordinal_position field specifies the explicit ordering of the usage of the algorithm with respect to the other algorithms used to encrypt or encode the malware configuration parameters, for cases where more than one algorithm was used."
                }
            }
        },
        "MalwareConfigurationParameterType": {
	    "title":"MalwareConfigurationParameter",
            "type": "object",
            "description": "The MalwareConfigurationParameterType captures a single configuration parameter that may be defined for a malware instance, as a name/value pair",
            "properties": {
                "name": {
                    "type": "string",
                    "description": "The name field specifies the name of the malware configuration parameter. The suggested vocabulary for this field is malware-configuration-parameter-ov.  Parameters not included in the vocabulary may also be specified, in which case it is recommended to use the exact name of the parameter."
                },
                "value": {
                    "type": "string",
                    "description": "The value field captures the value of the malware configuration parameter."
                }
            }
        }
    }
}
