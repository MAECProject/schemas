{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "CapabilityType": {
            "title":"Capability",
	        "type": "object",
            "description": "Captures details of a Capability that may be implemented in the malware instance.",
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Captures the name of the Capability. The values for this property SHOULD come from the Encyclopedia of Malware Attributes (EMA) Capabilities list. When used as part of a refined Capability, the values for this property SHOULD come from the Encyclopedia of Malware Attributes(EMA) Subcapabilities list."
                },
                "refined_capabilities": {
                    "type": "array",
                    "items": {"$ref": "#/definitions/CapabilityType"},
                    "description": "Specifies a refinement of the Capability using the same structure."
                },
                "description": {
                    "type": "string",
                    "description": "Captures a basic textual description of the Capability."
                },
                "attributes": {
                    "type": "object",
                    "items": {"$ref": "THIS NEEDS TO BE AN OPEN ENDED DICT"},
                    "description": "Captures attributes of the Capability as key/value pairs. Each key in the dictionary MUST be a string that captures the name of the attribute and SHOULD come from the common-attribute-ov vocabulary. Each corresponding key value MUST be a string or list of strings that captures the corresponding attribute values."
                },
                "behavior_refs": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "Specifies one or more Behaviors that serve as an implementation of the Capability. Each item in the list specifies the unique ID of the Behavior being referenced. The Behavior MUST be present in the current Package."
                },
                "references": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "format": "uri"
                    },
                    "description": "Specifies the ID of the corresponding entry in EMA. This property MUST be populated if the value of the name property references an EMA entry."
                }
            },
            "required": [
               "name"
            ]
        }
    }
}
