{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "BehaviorType": {
            "title":"Behavior",
	    "type": "object",
            "description": "The BehaviorType is one of the foundational MAEC types, and serves as a method for the characterization of malicious behaviors found or observed in malware. Behaviors can be thought of as representing the purpose behind groups of MAEC Actions, and are therefore representative of distinct portions of higher-level malware functionality. Thus, while a malware instance may perform some multitude of Actions, it is likely that these Actions represent only a few distinct behaviors. Some examples include vulnerability exploitation, email address harvesting, the disabling of a security service, etc.",
            "properties": {
                "type": {
                    "type": "string",
                    "enum": ["behavior"]
                },
                "id": {
                    "type": "string",
                    "description": "The required id field specifies a unique ID for this Behavior"
                },
                "name": {
                    "type": "string",
                    "description": "The required name field captures the name of the Behavior. The default vocabulary for this field is the BehaviorVocab from the MAEC Default Vocabularies schema"
                },
                "description": {
                    "type": "string",
                    "description": "The description field contains the basic textual description of the behavior."
                },
                "attributes": {
                    "type": "array",
                    "items": {"$ref": "#/definitions/AttributeType"},
                    "description": "The attribute field permits the capture of a single attribute of the Behavior, as a key/value pair. More than one attribute can be specified via multiple occurrences of this field."
                },
                "action_references": {
                    "type": "array",
                    "items": {"$ref": "#/definitions/BehaviorActionReferenceType"},
                    "description": "An action_reference specifies a reference to a single Action that serves as the underlying implementation of the Behavior. More than one such Action can be referenced via multiple occurrences of this field"
                },
                "status": {
                    "type": "string",
                    "description": "The status field specifies the execution status of the Behavior, i.e., whether or not it was successful. The available vocabulary for use with this field is execution-status-ov."
                },
                "incorporates_refs":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description": "The incorporates_ref field captures a reference to a Capability or Behavior that is incorporated by this Behavior"
                },
                "incorporated_by_refs":{
                    "type":"array",
                    "items":{"type":"string"},
                    "description": "The incorporated_by_ref field captures a reference to a Capability or Behavior that incorporates this Behavior"
                },
                "reference": {
                    "type": "string",
                    "format": "uri",
                    "description": "The reference field specifies the URL of the corresponding entry in the MAEC Semantic MediaWiki for the Behavior."
                }
            },
            "required": ["id"]
        },
        "BehaviorActionReferenceType": {
	    "title":"BehaviorActionReference",
            "type": "object",
            "description": "The BehaviorActionReferenceType specifies a reference to a single Action that serves as the underlying implementation of the Behavior. More than one such Action can be referenced via multiple occurrences of this field",
            "properties": {
                "action_ref": {
                    "type": "string",
                    "description": "The action_ref field refers to the id of the action being referenced"
                },
                "behavioral_ordering": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "The behavioral_ordering field defines the ordering of the Action with respect to the other Actions that make up the Behavior. For example, an Action with a behavioral_ordering of \"1\" would come before an Action with a behavioral_ordering of \"2\", etc."
                }
            },
            "required": ["action_ref"]
        },
        "AttributeType": {
	    "title":"Attribute",
            "type": "object",
            "description": "The AttributeType permits the capture of a single attribute of the Behavior, as a key/value pair. More than one attribute can be specified via multiple occurrences of this field.",
            "properties": {
                "name": {
                    "type": "string",
                    "description": "The name field specifies the name of the attribute being captured. The default vocabulary for this field is common-attribute-ov."
                },
                "value": {
                    "type": "string",
                    "description": "The value field specifies the value of the attribute being captured. The default vocabularies for this field are platform-ov, encryption-algorithm-ov, and technique-ov. Closed vocabularies have also been defined for some attributes: layer4-protocol-cv, layer7-protocol-cv."
                }
            }
        },
        "AssociatedCodeType": {
	    "title":"AssociatedCode",
            "type": "object",
            "description": "The AssociatedCodeType is a generic way of specifying any code snippets associated with a MAEC entity, such as a Behavior",
            "properties": {"code_snippet": {
                "$ref": "MalwareAction.json#/definitions/ObjectReferenceType",
                "description": "The code_snippet field references a CybOX Object, which MUST be a Code Object that captures a single snippet of code."
            }}
        }
    }
}
