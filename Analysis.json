{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "AnalysisType": {
            "type": "object",
            "description": "The AnalysisType provides a way of capturing the information associated with the analysis of a malware instance, such as the subject, authors, start datetime, and other relevant data.",
            "properties": {
                "id": {
                    "type": "string",
                    "description": "The required id field specifies a unique ID for this Analysis."
                },
                "type": {
                    "$ref": "Analysis.json#/definitions/AnalysisTypeEnum",
                    "description": "The type field specifies the type of malware analysis being performed."
                },
                "method": {
                    "$ref": "Analysis.json#/definitions/AnalysisMethodEnum",
                    "description": "The method field specifies the analysis method used in the analysis."
                },
                "ordinal_position": {
                    "type": "number",
                    "description": "The ordinal_position field specifies the ordering of the analysis with respect to the other analyses performed on the Malware Subject."
                },
                "start_datetime": {
                    "type": "string",
                    "format":"date-time",
                    "description": "The start_datetime field specifies the date/time the analysis was started."
                },
                "complete_datetime": {
                    "type": "string",
                    "format":"date-time",
                    "description": "The start_datetime field specifies the date/time the analysis was completed."
                },
                "last_update_datetime": {
                    "type": "string",
                    "format":"date-time",
                    "description": "The start_datetime field specifies the date/time the analysis was last updated."
                },
                "source": {
                    "$ref": "Analysis.json#/definitions/SourceType",
                    "definition": "The Source field specifies information about the internal or external source of the analysis, if applicable."
                },
                "analysts": {
                    "$ref": "#/PLACEHOLDER REFERENCE FOR cyboxCommon:PersonnelType",
                    "description": "The analysts field specifies the analyst(s) who performed the analysis."
                },
                "summary": {
                    "type": "string",
                    "description": "The summary field specifies a summary of the analysis that was performed.  It should be high-level and concise.  It should summarize the contents of the report field, if present, and otherwise should provide a brief synopsis of the analysis that was performed and any highlights."
                },
                "comments": {
                    "type": "array",
                    "items": {"$ref": "Analysis.json#/definitions/CommentType"},
                    "description": "The comments field specifies any comments regarding the analysis that was performed. A comment should be attributable to a specific analyst and should reflect particular insights of the author that are significant from an analysis standpoint.  The contents of comments are typically not contained in the report."
                },
                "findings": {
                    "$ref": "Analysis.json#/definitions/FindingsType",
                    "description": "The findings field specifies the findings of the analysis, via references to one or more other entities in the MAEC Package."
                },
                "tools": {
                    "type": "array",
                    "items": {"type":"string"},
                    "description": "The tools field captures a set of references to one or more Tools used in the analysis of a Malware Instance. Values MUST be references to Software Objects in the objects field at the top-level of the Package."
                },
                "dynamic_analysis_metadata": {
                    "$ref": "Analysis.json#/definitions/DynamicAnalysisMetadataType",
                    "description": "The dynamic_analysis_metadata field specifies metadata pertaining to the dynamic analysis of the subject binary, such as the command line used, the duration of the analysis, etc."
                },
                "analysis_environment": {
                    "$ref": "#/PLACEHOLDER FOR NOW - need to rethink this field",
                    "description": "The dynamic_analysis_metadata field specifies metadata pertaining to the dynamic analysis of the subject binary, such as the command line used, the duration of the analysis, etc."
                },
                "report": {
                    "type": "string",
                    "description": "The report field specifies the textual report regarding the analysis performed on the malware. The Report should correspond to the human-readable prose document that captures key aspects and outcomes of the analysis."
                }
            },
            "required": ["id"]
        },
        "SourceType": {
            "type": "object",
            "description": "The SourceType provides a way of characterizing the external source of a relevant MAEC entity, such as an Analysis.",
            "properties": {
                "name": {
                    "type": "string",
                    "description": "The name field refers to the name of the person linked to the source."
                },
                "method": {
                    "type": "string",
                    "description": "The method field provides an abstract way of specifying the method used to obtain the data that the Source element refers to."
                },
                "reference": {
                    "type": "string",
                    "description": "The reference field provides an abstract way of specifying a reference name or ID for the source."
                },
                "organization": {
                    "type": "string",
                    "description": "The organization field specifies the name of the organization from which the source originated."
                },
                "url": {
                    "type": "string",
                    "format": "uri",
                    "description": "The url field specifies the the Uniform Resource Locator (URL) of the external source, if applicable."
                }
            }
        },
        "CommentType": {
            "type": "object",
            "description": "The CommentType captures a comment relating to some MAEC field.",
            "properties": {
                "comment": {
                    "type": "string",
                    "description": "The comment field specifies the actual comment."
                },
                "author": {
                    "type": "string",
                    "description": "The author field specifies the name of the author that added the comment."
                },
                "timestamp": {
                    "type": "string",
                    "description": "The timestamp field specifies the date/time that the comment was added."
                },
                "observation_name": {
                    "type": "string",
                    "description": "The observation_name field captures the name, type, or identifier of an observation, for comments that refer to the observation of particular entities. For example, a comment that refers to a command and control (C2) encryption key could have an observation_name of \"C2 Encryption Key\"."
                }
            }
        },
        "FindingsType": {
            "type": "object",
            "description": "The FindingsType relates the findings of an analysis performed on a malware instance.",
            "properties": {
                "objects_ref": {
                    "type": "array",
                    "description": "The objects_ref references any CybOX Objects found as a result of the analysis."
                },
                "behaviors_ref": {
                    "type": "array",
                    "description": "The behaviors_ref references any Behaviors found as a result of the analysis."
                },
                "actions_ref": {
                    "type": "array",
                    "description": "The actions_ref references any Actions found as a result of the analysis."
                },
                "capabilities_ref": {
                    "type": "array",
                    "description": "The capabilities_ref references any Capabilities found as a result of the analysis."
                },
                "process_trees_ref": {
                    "type": "array",
                    "description": "The process_trees_ref references any Process Trees found as a result of the analysis."
                }
            }
        },
        "DynamicAnalysisMetadataType": {
            "type": "object",
            "description": "The DynamicAnalysisMetadataType captures any metadata specific to the dynamic analysis of a malware instance.",
            "properties": {
                "command_line": {
                    "type": "string",
                    "description": "The command_line field specifies the command line used to launch the subject binary."
                },
                "analysis_duration": {
                    "type": "number",
                    "description": "The analysis_duration field specifies the duration of the overall dynamic analysis process, in seconds."
                },
                "exit_code": {
                    "type": "string",
                    "description": "The exit_code field specifies the exit code with which the subject binary exited."
                },
                "raised_exceptions": {
                    "type": "array",
                    "items": {"$ref": "Analysis.json#/definitions/MalwareExceptionType"},
                    "description": "The raised_exceptions field captures the exceptions that were raised (or thrown) during the execution of the malware instance."
                }
            }
        },
        "MalwareExceptionType": {
            "type": "object",
            "description": "The MalwareExceptionType captures details of exceptions that may be raised as a result of a malware instance executing on a system.",
            "properties": {
                "is_fatal": {
                    "type": "boolean",
                    "description": "The is_fatal field specifies whether the exception is fatal; that is, whether it caused the malware instance to terminate."
                },
                "faulting_address": {
                    "type": "string",
                    "description": "The faulting_address field captures the memory address where the exception occurred."
                },
                "description": {
                    "type": "string",
                    "description": "The description field captures the textual description of the exception."
                },
                "exception_code": {
                    "type": "string",
                    "description": "The exception_code field captures the particular code that identifies the type of exception that occurred. "
                }
            }
        },
        "AnalysisTypeEnum": {
            "type": "string",
            "description": "The AnalysisTypeEnum is an enumeration of types of malware analyses.",
            "enum": [
                "triage",
                "in-depth"
            ]
        },
        "AnalysisMethodEnum": {
            "type": "string",
            "description": "The AnalysisMethodEnum is an enumeration of malware analysis methods.",
            "enum": [
                "static",
                "dynamic",
                "combination"
            ]
        }
    }
}