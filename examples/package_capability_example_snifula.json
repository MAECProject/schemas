{
	"id":"maec-test-pkg-1",
	"schema_version":"5.0",
	"malware_instances":[
		{
			"id":"maec-tst-sub-1",
			"instance_object_ref":"maec-tst-obj-1",
			"labels":[
				"dropper file"
			]
		},
		{
			"id":"maec-tst-sub-2",
			"instance_object_ref":"maec-tst-obj-2",
			"labels":[
				"dropper file"
			],
			"capability_refs":[
				"maec-tst-cpb-2",
				"maec-tst-cpb-3",
				"maec-tst-cpb-4",
				"maec-tst-cpb-5",
			],
			"behavior_refs":[
				"maec-tst-obt-5",
				"maec-tst-obt-7",
				"maec-tst-obt-9",
				"maec-tst-obt-11"
			]
		},
		{
			"id":"maec-tst-sub-3",
			"instance_object_ref":"maec-tst-obj-3",
			"labels":[
				"backdoor",
				"password stealer",
				"spyware",
				"trojan horse"
			],
			"analyses":[
				{
					"id":"maec-example-ana-1",
					"type": "in-depth",
					"method":"combination",
					"source":{
						"organization":"Computer Incident Response Center Luxembourg and National CERT of Luxembourg",
						"url":"https://www.circl.lu/files/tr-13/tr-13-snifula-analysis-report-v1.3.pdf"
					},
					"summary":"Malware analysis of a Backdoor.Snifula variant",
					"comments":[
						{
							"comment":"The malware binary exports 46 functions, but it seems most are used for camouflage, with only a single function actually being used."
						}
					],
					"findings":{
						"maec-example-findings-1":{
							"behavior_refs":[

							],
							"capability_refs":[
								"maec-tst-cpb-6",
								"maec-tst-cpb-7"
							],
						}
					}
				}
			]

		}
	],
	"cybox":{
		"objects":{
			"maec-tst-sub-1":{
				"type":"file",
				"file_name":"2a7.exe",
				"hashes":{
					"MD5":"eaa5e4f26028c41ba3935a4ac455892c",
					"SHA1":"049db2d7030bf7563974a2c25671aef046cabf99"
				}
			},
			"maec-tst-sub-2":{
				"type":"file",
				"file_name":"dump_006D0000.bin",
				"hashes":{
					"MD5":"d819facd7c980b01bf44ea7efbf6af42",
					"SHA1": "abfe4e74b345669a0fcd8a34bff9c9a0a7bc9c44"
				}
			},
			"maec-tst-obj-3":{
				"type":"file",
				"file_name":"ctfmreg.dll",
				"hashes":{
					"MD5":"f9005fd7eb85a81f2f9b1474bba61be0",
					"SHA1":"89196b0ed3189e8571924144e57aa867f72164bd"
				},
				(IS THERE A WAY TO EXTEND THIS WITH .dll fields)

			}
		},
	},
	"capabilities":[
		{
			"id":"maec-tst-cpb-2",
			"name":"probing",
			"refined_capabilities":[
				{
					"id":"maec-tst-obt-4",
					"name":"host configuration probing"
				}
			],
			"behavior_refs":[
				"maec-tst-obt-5"
			]
		},
		{
			"id":"maec-tst-cpb-3",
			"name":"anti-detection",
			"refined_capabilities":[
				{
					"id":"maec-tst-obt-6",
					"name":"hide artifacts"
				}
			],
			"behavior_refs":[
				"maec-tst-obt-7"
			]
		},
		{
			"id":"maec-tst-cpb-4",
			"name":"persistence",
			"refined_capabilities":[
				{
					"id":"maec-tst-obt-8",
					"name":"continuous execution"
				}
			],
			"behavior_refs":[
				"maec-tst-obt-9"
			]
		},
		{
			"id":"maec-tst-cpb-5",
			"name":"secondary operation",
			"refined_capabilities":[
				{
					"id":"maec-tst-obt-10",
					"name":"install other components"
				}
			],
			"behavior_refs":[
				"maec-tst-obt-11"
			]
		},
		{
			"id":"maec-tst-cpb-6",
			"name":"security degradation",
			"refined_capabilities":[
				{
					"id":"maec-tst-obt-12",
					"name":"prevent security software from executing"
				}
			],
			"attributes":[
				{
					"name":"targeted program",
					"value":"procmon.exe"
				}
			]
		},
		{
			"id":"maec-tst-cpb-7",
			"name":"persistence",
			"refined_capabilities":[
				{
					"id": "maec-tst-obt-14",
					"name":"ensure compatibility",
					"behavior_refs":[
						"maec-tst-obt-15"
					]
				},
				{
					"id":"maec-tst-obt-46",
					"name": "continuous execution",
					"behavior_refs":[
						"behavior-6"
					]
				}

			]
		},
		{
			"id":"maec-tst-cpb-8",
			"name":"command and control",
			"attributes":[
				{
					"name":"network protocol",
					"value":"http"
				}
			],
			"refined_capabilities":[
				{
					"id":"maec-tst-obt-16",
					"name":"receive data from c2 server",
					"behavior_refs":[
						"maec-tst-obt-20",
						"maec-tst-obt-21"
					]
				},
				{
					"id":"maec-tst-obt-17",
					"name":"send data to c2 server",
					"behavior_refs":[
						"maec-tst-obt-18",
						"maec-tst-obt-19"
					]
				}
			]

		},
		{
			"id":"maec-tst-cpb-9",
			"name":"secondary operation",
			"refined_capabilities":[
				{
					"id": "maec-tst-obt-45",
					"name": "install other components",
					"incorporated_by_refs":[
						"maec-obt-tst-20"
					],
					"incorporates_refs":[
						"maec-tst-obt-16",
						"maec-tst-obt-47"
					]
				},
			],
			"behavior_refs":[
				"maec-tst-obt-22"
			]
		}
	],
	"behaviors":[
		{
			"id":"maec-tst-obt-5",
			"name":"identify OS"
		}
		{
			"id":"maec-tst-obt-7",
			"name": "obfuscate artifact properties"
		},
		{
			"id":"maec-tst-obt-9",
			"name":"persist after system reboot"
		},
		{
			"id":"maec-tst-obt-11",
			"name":"install secondary module"
		},
		{
			"id":"maec-tst-obt-15",
			"name": "limit application type/version"
		},
		{
			"id":"maec-tst-obt-18",
			"name":"check for payload"
		},
		{
			"id":"maec-tst-obt-19",
			"name":  LEFT OFF HERE
		},
		{
			"id":"maec-tst-obt-20",
			"name":"control local machine via remote command"
		},
		{
			"id":"maec-tst-obt-21",
			"name":"update configuration"
		}
		{
			"id":"maec-tst-obt-22",
			"name":"log activity",
			"incorporated_by_refs":[
				"maec-tst-obt-20"
			],
			"incorporates_refs":[
				"maec-tst-obt-17"
			]
		},
		{
			"id":"maec-tst-obt-47",
			"name":"persist after system reboot",
			"attributes":[
				{
					"name":"scope",
					"value":"other malware/components"
				}
			],
			"incorporated_by_refs":[
				"maec-tst-obt-45"
			]
		}
	],
	"actions":[

	],
	"relationships":[
		{
			"id":"relationship-1",
			"source_ref":"maec-tst-sub-1",
			"target_ref":"maec-tst-sub-2",
			"type":"contained in memory image"
		},
		{
			"id":"relationship-2",
			"source_ref":"maec-tst-sub-1",
			"target_ref":"maec-tst-sub-4",
			"type":"contained in memory image"
		},
		{
			"id":"relationship-3",
			"source_ref":"maec-tst-sub-2",
			"target_ref":"maec-tst-sub-1",
			"type":"memory image of"
		},
		{
			"id":"relationship-4",
			"source_ref":"maec-tst-sub-2",
			"target_ref":"maec-tst-sub-3",
			"type":"drops"
		},
		{
			"id":"relationship-5",
			"source_ref":"maec-tst-sub-2",
			"target_ref":"maec-tst-sub-6",
			"type":"drops"
		},
		{
			"id":"relationship-6",
			"source_ref":"maec-tst-sub-2",
			"target_ref":"maec-tst-sub-3",
			"type":"installs"
		}
	]
}