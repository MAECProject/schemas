<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Bundle Candidate Indicator Example
 -Demonstrates how a Candidate Indicator may be constructed based on several objects used in malware actions
 -Based on ThreatExpert report http://www.threatexpert.com/report.aspx?md5=6519ed23fb22d0228e61a68d40f75c49
 
 Created November 2012 for MAEC v3.0 and CybOX v1.0 final
 Updated April 2013 for MAEC v4.0 and CybOX v2.0 
 Updated September 2013 for MAEC v4.0.1 and CybOX v2.0.1
 Updated January 2014 for MAEC v4.1 and CybOX v2.1 -->
<maecBundle:MAEC_Bundle
 xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-4"
 xmlns:maecVocabs="http://maec.mitre.org/default_vocabularies-1"
 xmlns:cyboxCommon="http://cybox.mitre.org/common-2"
 xmlns:cybox="http://cybox.mitre.org/cybox-2"
 xmlns:cyboxVocabs="http://cybox.mitre.org/default_vocabularies-2"
 xmlns:ProcessObj="http://cybox.mitre.org/objects#ProcessObject-2"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject-2"
 xmlns:MutexObj="http://cybox.mitre.org/objects#MutexObject-2"
 xmlns:WinExecutableFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject-2"
 xmlns:WinRegistryKeyObj="http://cybox.mitre.org/objects#WinRegistryKeyObject-2"
 xmlns:WinMutexObj="http://cybox.mitre.org/objects#WinMutexObject-2"
 xmlns:WinProcessObj="http://cybox.mitre.org/objects#WinProcessObject-2"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation=
 "http://maec.mitre.org/XMLSchema/maec-bundle-4 ../maec_bundle_schema.xsd
 http://maec.mitre.org/default_vocabularies-1 ../maec_default_vocabularies.xsd
 http://cybox.mitre.org/default_vocabularies-2 http://cybox.mitre.org/XMLSchema/default_vocabularies/2.0.1/cybox_default_vocabularies.xsd 
 http://cybox.mitre.org/cybox-2 http://cybox.mitre.org/XMLSchema/core/2.0.1/cybox_core.xsd
 http://cybox.mitre.org/objects#WinExecutableFileObject-2 http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/2.0.1/Win_Executable_File_Object.xsd
 http://cybox.mitre.org/objects#WinRegistryKeyObject-2 http://cybox.mitre.org/XMLSchema/objects/Win_Registry_Key/2.0.1/Win_Registry_Key_Object.xsd
 http://cybox.mitre.org/objects#WinMutexObject-2 http://cybox.mitre.org/XMLSchema/objects/Win_Mutex/2.0.1/Win_Mutex_Object.xsd
 http://cybox.mitre.org/objects#WinProcessObject-2 http://cybox.mitre.org/XMLSchema/objects/Win_Process/2.0.1/Win_Process_Object.xsd" 
 id="maec-example-bnd-1" schema_version="4.1" defined_subject="true" content_type="mixed">
<maecBundle:Malware_Instance_Object_Attributes>
 <cybox:Properties xsi:type="WinExecutableFileObj:WindowsExecutableFileObjectType">
  <FileObj:Size_In_Bytes>332288</FileObj:Size_In_Bytes>
  <FileObj:Hashes>
   <cyboxCommon:Hash>
    <cyboxCommon:Type xsi:type="cyboxVocabs:HashNameVocab-1.0">MD5</cyboxCommon:Type>
    <cyboxCommon:Simple_Hash_Value>6519ED23FB22D0228E61A68D40F75C49</cyboxCommon:Simple_Hash_Value>
   </cyboxCommon:Hash>
   <cyboxCommon:Hash>
    <cyboxCommon:Type xsi:type="cyboxVocabs:HashNameVocab-1.0">SHA1</cyboxCommon:Type>
    <cyboxCommon:Simple_Hash_Value>7F42DF6B1318A5CC4633E33076629F95F59F1445</cyboxCommon:Simple_Hash_Value>
   </cyboxCommon:Hash>
  </FileObj:Hashes>
 </cybox:Properties>
</maecBundle:Malware_Instance_Object_Attributes>
 
<maecBundle:Actions>
 <maecBundle:Action id="maec-example-act-1" >
  <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name> 
  <cybox:Associated_Objects>
   <cybox:Associated_Object id="maec-example-obj-1">
    <cybox:Properties xsi:type="WinExecutableFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name>Zcxaxz.exe</FileObj:File_Name>
     <FileObj:File_Path>%AppData%\</FileObj:File_Path>
     <FileObj:Size_In_Bytes>332288</FileObj:Size_In_Bytes>
    </cybox:Properties>
    <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
   </cybox:Associated_Object>
  </cybox:Associated_Objects>
 </maecBundle:Action>
 
 <maecBundle:Action id="maec-example-act-2">
  <cybox:Name xsi:type="maecVocabs:RegistryActionNameVocab-1.0">create registry key</cybox:Name>
  <cybox:Associated_Objects>
   <cybox:Associated_Object id="maec-example-obj-2">
    <cybox:Properties xsi:type="WinRegistryKeyObj:WindowsRegistryKeyObjectType">
     <WinRegistryKeyObj:Key>Software\Microsoft\Windows\CurrentVersion\Run</WinRegistryKeyObj:Key>
     <WinRegistryKeyObj:Hive>HKEY_CURRENT_USER</WinRegistryKeyObj:Hive>
     <WinRegistryKeyObj:Values>
      <WinRegistryKeyObj:Value>
       <WinRegistryKeyObj:Name>Zcxaxz</WinRegistryKeyObj:Name>
       <WinRegistryKeyObj:Data>"%AppData%\Zcxaxz.exe"</WinRegistryKeyObj:Data>
      </WinRegistryKeyObj:Value>
     </WinRegistryKeyObj:Values>
    </cybox:Properties>
    <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
   </cybox:Associated_Object>
  </cybox:Associated_Objects>
 </maecBundle:Action>
 
 <maecBundle:Action id="maec-example-act-3">
  <cybox:Name xsi:type="maecVocabs:SynchronizationActionNameVocab-1.0">create mutex</cybox:Name>
  <cybox:Associated_Objects>
   <cybox:Associated_Object id="maec-example-obj-3">
    <cybox:Properties xsi:type="WinMutexObj:WindowsMutexObjectType" named="true">
     <MutexObj:Name>redem-Mutex</MutexObj:Name>
    </cybox:Properties>
    <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
   </cybox:Associated_Object>
  </cybox:Associated_Objects>
 </maecBundle:Action>
 
 <maecBundle:Action id="maec-example-act-4">
  <cybox:Name xsi:type="maecVocabs:ProcessMemoryActionNameVocab-1.0">allocate process virtual memory</cybox:Name>
  <cybox:Associated_Objects>
   <cybox:Associated_Object id="maec-example-obj-4">
    <cybox:Properties xsi:type="WinProcessObj:WindowsProcessObjectType">
     <ProcessObj:Name>services.exe</ProcessObj:Name>
     <ProcessObj:Image_Info>
      <ProcessObj:Path>%System%\services.exe</ProcessObj:Path>
     </ProcessObj:Image_Info>
    </cybox:Properties>
    <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
   </cybox:Associated_Object>
  </cybox:Associated_Objects>
 </maecBundle:Action>
 
 <maecBundle:Action id="maec-example-act-5">
  <cybox:Name xsi:type="maecVocabs:ProcessMemoryActionNameVocab-1.0">allocate process virtual memory</cybox:Name>
  <cybox:Associated_Objects>
   <cybox:Associated_Object id="maec-example-obj-5">
    <cybox:Properties xsi:type="WinProcessObj:WindowsProcessObjectType">
     <ProcessObj:Name>svchost.exe</ProcessObj:Name>
     <ProcessObj:Image_Info>
      <ProcessObj:Path>%System%\svchost.exe</ProcessObj:Path>
     </ProcessObj:Image_Info>
    </cybox:Properties>
    <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
   </cybox:Associated_Object>
  </cybox:Associated_Objects>
 </maecBundle:Action>
 
 <maecBundle:Action id="maec-example-act-6">
  <cybox:Name xsi:type="maecVocabs:ProcessMemoryActionNameVocab-1.0">allocate process virtual memory</cybox:Name>
  <cybox:Associated_Objects>
   <cybox:Associated_Object id="maec-example-obj-6">
    <cybox:Properties xsi:type="WinProcessObj:WindowsProcessObjectType">
     <ProcessObj:Name>alg.exe</ProcessObj:Name>
     <ProcessObj:Image_Info>
      <ProcessObj:Path>%System%\alg.exe</ProcessObj:Path>
     </ProcessObj:Image_Info>
    </cybox:Properties>
    <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
   </cybox:Associated_Object>
  </cybox:Associated_Objects>
 </maecBundle:Action>
</maecBundle:Actions>
 
 <maecBundle:Candidate_Indicators>
  <!-- An example of a simple object-based candidate indicator for the characterized malware instance -->
  <maecBundle:Candidate_Indicator id="maec-example-ind-1">
   <maecBundle:Composition operator="OR">
    <maecBundle:Object_Reference object_idref="maec-example-obj-3"/>
    <maecBundle:Sub_Composition operator="AND">
     <maecBundle:Object_Reference object_idref="maec-example-obj-1"/>
     <maecBundle:Object_Reference object_idref="maec-example-obj-2"/>
    </maecBundle:Sub_Composition>
   </maecBundle:Composition>
  </maecBundle:Candidate_Indicator>
 </maecBundle:Candidate_Indicators>
</maecBundle:MAEC_Bundle>
