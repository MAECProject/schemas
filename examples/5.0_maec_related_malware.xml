<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Related Malware
 -Demonstrates how multi-partite malware may be captured as unique Malware Subjects in a Package
 -Shows how the relationships between the multiple related Malware Subjects are constructed
 -Based on SANS Reading Room Paper: A Detailed Analysis of an Advanced Persistent Threat Malware, by Frankie Li. http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814
 -Updated May 2016 for MAEC 5.0 
-->
<maecPackage:MAEC_Package
 xmlns:maecVocabs="http://maec.mitre.org/XMLSchema/default_vocabularies-1"
 xmlns:maecCore="http://maec.mitre.org/XMLSchema/maec-core-1"
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-5"
 xmlns:cybox="http://cybox.mitre.org/cybox-2"
 xmlns:cyboxCommon="http://cybox.mitre.org/common-2"
 xmlns:cyboxVocabs="http://cybox.mitre.org/default_vocabularies-2"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject-2"
 xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject-2"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns:example="example.com"
 xsi:schemaLocation=
 "http://maec.mitre.org/XMLSchema/maec-package-5 ../maec_package_schema.xsd
 http://maec.mitre.org/XMLSchema/maec-core-1 ../maec_core_schema.xsd
 http://maec.mitre.org/XMLSchema/default_vocabularies-1 ../maec_default_vocabularies.xsd
 http://cybox.mitre.org/default_vocabularies-2 http://cybox.mitre.org/XMLSchema/default_vocabularies/2.1/cybox_default_vocabularies.xsd
 http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/2.1/Win_Executable_File_Object.xsd" 
 id="example:package-e05d8112-4210-4367-b9ed-8370acdee129" schema_version="5.0">

 <maecPackage:Malware_Subjects>
  <maecPackage:Malware_Subject id="example:malware_subject-94">
   <maecPackage:Instance_Object object_idref="maec-obj-1"/>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="example:malware_subject-ec">
   <maecPackage:Instance_Object object_idref="maec-obj-2"/>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="example:malware_subject-d7">
   <maecPackage:Instance_Object object_idref="maec-obj-3"/>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="example:malware_subject-6d">
   <maecPackage:Instance_Object object_idref="maec-obj-4"/>
  </maecPackage:Malware_Subject>
 </maecPackage:Malware_Subjects>
  
 <maecPackage:Objects>
  <maecCore:Object id="maec-obj-1">
   <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
    <FileObj:File_Name>dg003_improve_8080_V132.exe</FileObj:File_Name>
    <FileObj:Size_In_Bytes>196608</FileObj:Size_In_Bytes>
    <FileObj:Hashes>
     <cyboxCommon:Hash>
      <cyboxCommon:Type xsi:type="cyboxVocabs:HashNameVocab-1.0">MD5</cyboxCommon:Type>
      <cyboxCommon:Simple_Hash_Value>4EC0027BEF4D7E1786A04D021FA8A67F</cyboxCommon:Simple_Hash_Value>
     </cyboxCommon:Hash>
    </FileObj:Hashes>
   </cybox:Properties>
  </maecCore:Object>
  <maecCore:Object id="maec-obj-2">
   <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
    <FileObj:File_Name>msvcr.dll</FileObj:File_Name>
   </cybox:Properties>
  </maecCore:Object>
  <maecCore:Object id="maec-obj-3">
   <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
    <FileObj:File_Name>fvcwin32.exe</FileObj:File_Name>
   </cybox:Properties>
  </maecCore:Object>
  <maecCore:Object id="maec-obj-4">
   <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
    <FileObj:File_Name>acvcwin32.exe</FileObj:File_Name>
   </cybox:Properties>
  </maecCore:Object>
 </maecPackage:Objects>
 
 <maecPackage:Collections>
  <maecPackage:Collection id="maec-collection-1" maec_entity_type="malware subjects" association_type="observed together">
   <maecPackage:Entity_Reference entity_idref="example:malware_subject-94"/>
   <maecPackage:Entity_Reference entity_idref="example:malware_subject-ec"/>
   <maecPackage:Entity_Reference entity_idref="example:malware_subject-d7"/>
   <maecPackage:Entity_Reference entity_idref="example:malware_subject-6d"/>
  </maecPackage:Collection>
 </maecPackage:Collections>
 
 <maecPackage:Relationships>
  <maecPackage:Relationship source_id="malware_subject-94" target_id="example:malware_subject-ec">
   <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">drops</maecPackage:Type>
  </maecPackage:Relationship>
  <maecPackage:Relationship source_id="example:malware_subject-ec" target_id="example:malware_subject-94">
   <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">dropped by</maecPackage:Type>
  </maecPackage:Relationship>
  <maecPackage:Relationship source_id="example:malware_subject-ec" target_id="example:malware_subject-d7">
   <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">downloads</maecPackage:Type>
  </maecPackage:Relationship>
  <maecPackage:Relationship source_id="example:malware_subject-ec" target_id="example:malware_subject-6d">
   <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">downloads</maecPackage:Type>
  </maecPackage:Relationship>
  <maecPackage:Relationship source_id="example:malware_subject-d7" target_id="example:malware_subject-ec">
   <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">downloaded by</maecPackage:Type>
  </maecPackage:Relationship>
  <maecPackage:Relationship source_id="example:malware_subject-6d" target_id="example:malware_subject-ec">
   <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">downloaded by</maecPackage:Type>
  </maecPackage:Relationship>
 </maecPackage:Relationships>
 
</maecPackage:MAEC_Package>
