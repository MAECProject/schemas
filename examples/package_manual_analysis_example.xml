<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Package Manual Triage Analysis Example
 -Demonstrates how a Package/Malware Subject can be used to capture manual malware analysis tool output for a malware instance
 -Specifically, it shows how existing and new Actions can be used to construct Behaviors
 -Based on SANS Reading Room Paper: A Detailed Analysis of an Advanced Persistent Threat Malware, by Frankie Li. http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814
 -This example builds upon the dynamic triage example (http://maec.mitre.org/language/version4.0/package_dynamic_triage_example.xml)
 
 Updated November 2012 for MAEC v3.0 and CybOX v1.0 final
 Updated April 2013 for MAEC v4.0 and CybOX v2.0 final-->
<maecPackage:MAEC_Package
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-2"
 xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-4"
 xmlns:maecVocabs="http://maec.mitre.org/default_vocabularies-1"
 xmlns:cybox="http://cybox.mitre.org/cybox-2"
 xmlns:cyboxCommon="http://cybox.mitre.org/common-2"
 xmlns:cyboxVocabs="http://cybox.mitre.org/default_vocabularies-2"
 xmlns:AddressObj="http://cybox.mitre.org/objects#AddressObject-2"
 xmlns:ProcessObj="http://cybox.mitre.org/objects#ProcessObject-2"
 xmlns:WinProcessObj="http://cybox.mitre.org/objects#WinProcessObject-2"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject-2"
 xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject-2"
 xmlns:MutexObj="http://cybox.mitre.org/objects#MutexObject-2"
 xmlns:WinMutexObj="http://cybox.mitre.org/objects#WinMutexObject-2"
 xmlns:WinRegistryKeyObj="http://cybox.mitre.org/objects#WinRegistryKeyObject-2"
 xmlns:URIObj="http://cybox.mitre.org/objects#URIObject-2"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-package-2 http://maec.mitre.org/language/version4.0/maec_package_schema.xsd
 http://maec.mitre.org/default_vocabularies-1 http://maec.mitre.org/language/version4.0/maec_default_vocabularies.xsd
 http://cybox.mitre.org/default_vocabularies-2 http://cybox.mitre.org/XMLSchema/default_vocabularies/2.0.0/cybox_default_vocabularies.xsd 
 http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/2.0/Win_Executable_File_Object.xsd
 http://cybox.mitre.org/objects#WinMutexObject http://cybox.mitre.org/XMLSchema/objects/Win_Mutex/2.0/Win_Mutex_Object.xsd 
 http://cybox.mitre.org/objects#WinProcessObject http://cybox.mitre.org/XMLSchema/objects/Win_Process/2.0/Win_Process_Object.xsd 
 http://cybox.mitre.org/objects#WinRegistryKeyObject-2 http://cybox.mitre.org/XMLSchema/objects/Win_Registry_Key/2.0/Win_Registry_Key_Object.xsd 
 http://cybox.mitre.org/objects#URIObject http://cybox.mitre.org/XMLSchema/objects/URI/2.0/URI_Object.xsd" 
 id="maec-example-pkg-1" schema_version="2.0">
 
 <maecPackage:Malware_Subjects>
  <maecPackage:Malware_Subject id="maec-example-sub-1">
   <maecPackage:Malware_Instance_Object_Attributes>
    <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name>dg003_improve_8080_V132.exe</FileObj:File_Name>
     <FileObj:Size_In_Bytes>196608</FileObj:Size_In_Bytes>
     <FileObj:Hashes>
      <cyboxCommon:Hash>
       <cyboxCommon:Type xsi:type="cyboxVocabs:HashNameVocab-1.0">MD5</cyboxCommon:Type>
       <cyboxCommon:Simple_Hash_Value>4EC0027BEF4D7E1786A04D021FA8A67F</cyboxCommon:Simple_Hash_Value>
      </cyboxCommon:Hash>
     </FileObj:Hashes>
    </cybox:Properties>
   </maecPackage:Malware_Instance_Object_Attributes>
   
   <maecPackage:Analyses>
    <maecPackage:Analysis id="maec-example-ana-1" method="static" type="triage">
     <maecPackage:Source>
      <maecPackage:Name>Frankie Li</maecPackage:Name>
      <maecPackage:URL>http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814</maecPackage:URL>
     </maecPackage:Source>
     <maecPackage:Summary>A basic static triage of the subject binary using PEiD.</maecPackage:Summary>
     <maecPackage:Findings_Bundle_Reference bundle_idref="maec-example-bnd-1"/>
     <maecPackage:Tools>
      <maecPackage:Tool id="analysis-tool-1">
       <cyboxCommon:Name>PEiD</cyboxCommon:Name>
       <cyboxCommon:Version>0.94</cyboxCommon:Version>
      </maecPackage:Tool>
     </maecPackage:Tools>
    </maecPackage:Analysis>
    
    <maecPackage:Analysis id="maec-example-ana-2" method="dynamic" type="triage">
     <maecPackage:Source>
      <maecPackage:Name>Frankie Li</maecPackage:Name>
      <maecPackage:URL>http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814</maecPackage:URL>
     </maecPackage:Source>
     <maecPackage:Summary>Dynamic (behavioral) and tool-based triage of the subject
      binary.</maecPackage:Summary>
     <maecPackage:Findings_Bundle_Reference bundle_idref="maec-example-bnd-2"/>
     <maecPackage:Tools>
      <maecPackage:Tool id="analysis-tool-2">
       <cyboxCommon:Name>CaptureBAT</cyboxCommon:Name>
       <cyboxCommon:Vendor>Zealand Honeynet Project</cyboxCommon:Vendor>
       <cyboxCommon:Version>2.0.0</cyboxCommon:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-3">
       <cyboxCommon:Name>Regshot</cyboxCommon:Name>
       <cyboxCommon:Version>v1.8.2</cyboxCommon:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-4">
       <cyboxCommon:Name>HandleDiff</cyboxCommon:Name>
       <cyboxCommon:Version>v.0.2</cyboxCommon:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-5">
       <cyboxCommon:Name>VMMap</cyboxCommon:Name>
       <cyboxCommon:Vendor>Sysinternals</cyboxCommon:Vendor>
       <cyboxCommon:Version>3.1</cyboxCommon:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-6">
       <cyboxCommon:Name>Wireshark</cyboxCommon:Name>
       <cyboxCommon:Vendor>Wireshark.org</cyboxCommon:Vendor>
       <cyboxCommon:Version>1.2.2</cyboxCommon:Version>
      </maecPackage:Tool>
      
      <maecPackage:Tool id="analysis-tool-7">
       <cyboxCommon:Name>Process Monitor</cyboxCommon:Name>
       <cyboxCommon:Vendor>Sysinternals</cyboxCommon:Vendor>
       <cyboxCommon:Version>15.0</cyboxCommon:Version>
      </maecPackage:Tool>
     </maecPackage:Tools>
    </maecPackage:Analysis>
    
    <maecPackage:Analysis id="maec-example-ana-3" method="static" type="manual">
     <maecPackage:Source>
      <maecPackage:Name>Frankie Li</maecPackage:Name>
      <maecPackage:URL>http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814</maecPackage:URL>
     </maecPackage:Source>
     <maecPackage:Summary>Manual analysis of the main subject binary.</maecPackage:Summary>
     <maecPackage:Findings_Bundle_Reference bundle_idref="maec-example-bnd-3"/>
     <maecPackage:Tools>
      <maecPackage:Tool id="analysis-tool-8">
       <cyboxCommon:Name>IDA Pro Freeware</cyboxCommon:Name>
       <cyboxCommon:Vendor>Hex-Rays SA</cyboxCommon:Vendor>
       <cyboxCommon:Version>5.0</cyboxCommon:Version>
      </maecPackage:Tool>
     </maecPackage:Tools>
    </maecPackage:Analysis>
   </maecPackage:Analyses>
   
   <maecPackage:Findings_Bundles>
  <maecPackage:Bundle id="maec-example-bnd-1" schema_version="4.0" defined_subject="false" content_type="extracted from subject">
     <maecBundle:Objects>
      <maecBundle:Object id="maec-example-obj-1">
        <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
          <WinExecFileObj:Headers>
           <WinExecFileObj:Optional_Header>
            <WinExecFileObj:Major_Linker_Version>06</WinExecFileObj:Major_Linker_Version>
            <WinExecFileObj:Minor_Linker_Version>00</WinExecFileObj:Minor_Linker_Version>
            <WinExecFileObj:Base_Of_Code>036418</WinExecFileObj:Base_Of_Code>
            <WinExecFileObj:Subsystem>Windows_GUI</WinExecFileObj:Subsystem>
           </WinExecFileObj:Optional_Header>
          </WinExecFileObj:Headers>
          <WinExecFileObj:Type>Executable</WinExecFileObj:Type>
        </cybox:Properties>
       </maecBundle:Object>
     </maecBundle:Objects>
    </maecPackage:Bundle>
    
    <maecPackage:Bundle id="maec-example-bnd-2" schema_version="4.0" defined_subject="false" content_type="dynamic analysis tool output">
     <maecBundle:Process_Tree>
      <maecBundle:Root_Process id="maec-example-pro-1">
       <ProcessObj:Image_Info>
        <ProcessObj:Path>dg003.exe</ProcessObj:Path>
       </ProcessObj:Image_Info>
       <maecBundle:Initiated_Actions>
        <maecBundle:Action_Reference action_id="maec-example-act-1"/>
        <maecBundle:Action_Reference action_id="maec-example-act-2"/>
        <maecBundle:Action_Reference action_id="maec-example-act-3"/>
        <maecBundle:Action_Reference action_id="maec-example-act-4"/>
        <maecBundle:Action_Reference action_id="maec-example-act-5"/>
       </maecBundle:Initiated_Actions>
       <maecBundle:Injected_Process id="maec-example-pro-2" parent_action_idref="maec-example-act-10">
        <ProcessObj:Image_Info>
         <ProcessObj:Path>explorer.exe</ProcessObj:Path>
        </ProcessObj:Image_Info>
        <maecBundle:Initiated_Actions>
         <maecBundle:Action_Reference action_id="maec-example-act-6"/>
         <maecBundle:Action_Reference action_id="maec-example-act-7"/>
         <maecBundle:Action_Reference action_id="maec-example-act-9"/>
         <maecBundle:Action_Reference action_id="maec-example-act-18"/>
         <maecBundle:Action_Reference action_id="maec-example-act-19"/>
         <maecBundle:Action_Reference action_id="maec-example-act-20"/>
         <maecBundle:Action_Reference action_id="maec-example-act-21"/>
         <maecBundle:Action_Reference action_id="maec-example-act-22"/>
         <maecBundle:Action_Reference action_id="maec-example-act-23"/>
         <maecBundle:Action_Reference action_id="maec-example-act-24"/>
         <maecBundle:Action_Reference action_id="maec-example-act-25"/>
        </maecBundle:Initiated_Actions>
        <maecBundle:Spawned_Process id="maec-example-pro-3" parent_action_idref="maec-example-act-21">
         <ProcessObj:Image_Info>
          <ProcessObj:Path>fvcwin32.exe</ProcessObj:Path>
         </ProcessObj:Image_Info>
        </maecBundle:Spawned_Process>
        <maecBundle:Spawned_Process id="maec-example-pro-4" parent_action_idref="maec-example-act-22">
         <ProcessObj:Image_Info>
          <ProcessObj:Path>acvcwin32.exe</ProcessObj:Path>
         </ProcessObj:Image_Info>
        </maecBundle:Spawned_Process>
        <maecBundle:Spawned_Process id="maec-example-pro-5" parent_action_idref="maec-example-act-10">
         <ProcessObj:Image_Info>
          <ProcessObj:Path>avcwin32.exe</ProcessObj:Path>
         </ProcessObj:Image_Info>
         <maecBundle:Initiated_Actions>
          <maecBundle:Action_Reference action_id="maec-example-act-26"/>
          <maecBundle:Action_Reference action_id="maec-example-act-27"/>
          <maecBundle:Action_Reference action_id="maec-example-act-28"/>
          <maecBundle:Action_Reference action_id="maec-example-act-29"/>
         </maecBundle:Initiated_Actions>
        </maecBundle:Spawned_Process>
       </maecBundle:Injected_Process>
      </maecBundle:Root_Process>
     </maecBundle:Process_Tree>
     
     <maecBundle:Actions>
       <maecBundle:Action id="maec-example-act-1" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-2">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>ws2help.PNF</FileObj:File_Name>
           <FileObj:Full_Path condition="FitsPattern" pattern_type="Regex">^C:\\Documents and Settings\\\s+user\s+\\Local Settings\\Application\\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
      </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-2" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
          <cyboxCommon:Tools>
           <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-3">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>msvcr.dll</FileObj:File_Name>
           <FileObj:Full_Path condition="FitsPattern" pattern_type="Regex">^C:\\Documents and Settings\\\s+user\s+\\Local Settings\\Application\\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-3" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-4">
          <cybox:Properties xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name>1.txt</FileObj:File_Name>
           <FileObj:Full_Path>C:\Windows\inf</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
         </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-4" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">modify file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-5">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>netstat.exe</FileObj:File_Name>
           <FileObj:Full_Path>C:\Windows\system32</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
         </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-5" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-6">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>IECheck.exe</FileObj:File_Name>
           <FileObj:Full_Path condition="FitsPattern" pattern_type="Regex">^C:\\Documents and Settings\\\s+user\s+\\Local Settings\\Application\\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-6" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-7">
          <cybox:Properties xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name>IPsecstap.dat</FileObj:File_Name>
           <FileObj:Full_Path>C:\Windows\system32</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-7" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-8">
          <cybox:Properties xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name>Internet Explorer Security Check.lnk</FileObj:File_Name>
           <FileObj:Full_Path condition="FitsPattern" pattern_type="Regex">^C:\\Documents and Settings\\\s+user\s+\\Start Menu\\Programs\\Startup</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
         </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-8" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-3"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-9">
          <cybox:Properties xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name>13605</FileObj:File_Name>
           <FileObj:Full_Path>C:\Windows\system32</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-9" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:SynchronizationActionNameVocab-1.0">create mutex</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-4"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-10">
          <cybox:Properties xsi:type="WinMutexObj:WindowsMutexObjectType">
           <MutexObj:Name condition="Contains">VistaDLLProRUNNING</MutexObj:Name>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-10" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:ProcessThreadActionNameVocab-1.0">create remote thread in process</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-5"/>
         </cyboxCommon:Tools>
         </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-11">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>msvcr.dll</FileObj:File_Name>
           <FileObj:Full_Path condition="FitsPattern" pattern_type="Regex">^C:\\Documents and Settings\\\s+user\s+\\Local Settings\\Application\\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
         <cybox:Associated_Object id="maec-example-obj-12">
          <cybox:Properties xsi:type="WinProcessObj:WindowsProcessObjectType">
           <ProcessObj:Image_Info>
            <ProcessObj:Command_Line>explorer.exe</ProcessObj:Command_Line>
            <ProcessObj:Path>C:\Windows\</ProcessObj:Path>
           </ProcessObj:Image_Info>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
        <cybox:Relationships>
         <cybox:Relationship>
          <cybox:Type xsi:type="cyboxVocabs:ActionRelationshipTypeVocab-1.0">Preceded_By</cybox:Type>
          <cybox:Action_Reference action_id="maec-example-act-2"/>
         </cybox:Relationship>
        </cybox:Relationships>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-11" context="Network" action_status="Fail">
        <cybox:Name xsi:type="maecVocabs:DNSActionNameVocab-1.0">send dns query</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-6"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-13">
          <cybox:Properties xsi:type="URIObj:URIObjectType">
           <URIObj:Value>test.3322.org.cn</URIObj:Value>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-12" context="Network" action_status="Fail">
        <cybox:Name xsi:type="maecVocabs:DNSActionNameVocab-1.0">send dns query</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-6"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-14">
          <cybox:Properties xsi:type="URIObj:URIObjectType">
           <URIObj:Value>1.test.3322.org.cn</URIObj:Value>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-13" context="Network" action_status="Fail">
        <cybox:Name xsi:type="maecVocabs:DNSActionNameVocab-1.0">send dns query</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-6"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-15">
          <cybox:Properties xsi:type="URIObj:URIObjectType">
           <URIObj:Value>2.test.3322.org.cn</URIObj:Value>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-14" context="Network" action_status="Fail">
        <cybox:Name xsi:type="maecVocabs:DNSActionNameVocab-1.0">send dns query</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-6"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-16">
          <cybox:Properties xsi:type="URIObj:URIObjectType">
           <URIObj:Value>3.test.3322.org.cn</URIObj:Value>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object> 
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-15" context="Network" action_status="Fail">
        <cybox:Name xsi:type="maecVocabs:DNSActionNameVocab-1.0">send dns query</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-6"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-17">
          <cybox:Properties xsi:type="URIObj:URIObjectType">
           <URIObj:Value>4.test.3322.org.cn</URIObj:Value>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-16" context="Network" action_status="Fail">
        <cybox:Name xsi:type="maecVocabs:NetworkActionNameVocab-1.0">connect to ip</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-6"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-18">
          <cybox:Properties xsi:type="AddressObj:AddressObjectType" category="ipv4-addr">
           <AddressObj:Address_Value>172.16.0.61</AddressObj:Address_Value>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-17"  context="Network" action_status="Fail">
        <cybox:Name xsi:type="maecVocabs:NetworkActionNameVocab-1.0">connect to ip</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-6"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-19">
          <cybox:Properties xsi:type="AddressObj:AddressObjectType" category="ipv4-addr">
           <AddressObj:Address_Value condition="FitsPattern" pattern_type="Regex">^115\..*\..*\.249</AddressObj:Address_Value>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-18" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-20">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>fvcwin32.exe</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-19" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-21">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>acvcwin32.exe</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-20" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-22">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>avcwin32.exe</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-21" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:ProcessActionNameVocab-1.0">create process</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-7"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-23">
          <cybox:Properties xsi:type="WinProcessObj:WindowsProcessObjectType">
           <ProcessObj:Image_Info>
            <ProcessObj:Command_Line>fvcwin32.exe</ProcessObj:Command_Line>
            <ProcessObj:Path>C:\WINDOWS\Debug</ProcessObj:Path>
           </ProcessObj:Image_Info>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-22" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:ProcessActionNameVocab-1.0">create process</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-7"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-24">
          <cybox:Properties xsi:type="WinProcessObj:WindowsProcessObjectType">
           <ProcessObj:Image_Info>
            <ProcessObj:Command_Line>acvcwin32.exe</ProcessObj:Command_Line>
            <ProcessObj:Path>C:\WINDOWS\Debug</ProcessObj:Path>
           </ProcessObj:Image_Info>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-23" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:ProcessActionNameVocab-1.0">create process</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-7"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-25">
          <cybox:Properties xsi:type="WinProcessObj:WindowsProcessObjectType">
           <ProcessObj:Image_Info>
            <ProcessObj:Command_Line>avcwin32.exe</ProcessObj:Command_Line>
            <ProcessObj:Path>C:\WINDOWS\Debug</ProcessObj:Path>
           </ProcessObj:Image_Info>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-24" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-26">
          <cybox:Properties xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name>AutoList.txt</FileObj:File_Name>
           <FileObj:Full_Path condition="FitsPattern" pattern_type="Regex">^C:\\Documents and Settings\\.*\\Application Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-25" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-27">
          <cybox:Properties xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name>AutoList.txt</FileObj:File_Name>
           <FileObj:Full_Path condition="FitsPattern" pattern_type="Regex">^C:\\Documents and Settings\\.*\\Application Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-26" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-28">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>SAM.dll</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-27" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-29">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>system.dll</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
       
       <maecBundle:Action id="maec-example-act-28" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-30">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>system.dll</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-29" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-31">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>Iestorage.dll</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-30" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-32">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>SAM.dll</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-31" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-33">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>system.dll</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-32" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-34">
          <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
           <FileObj:File_Name>iestorage.dll</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
     
       <maecBundle:Action id="maec-example-act-33" context="Host" action_status="Success">
        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
        <cybox:Discovery_Method source_type="Tool">
         <cyboxCommon:Tools>
          <cyboxCommon:Tool idref="analysis-tool-2"/>
         </cyboxCommon:Tools>
        </cybox:Discovery_Method>
        <cybox:Associated_Objects>
         <cybox:Associated_Object id="maec-example-obj-35">
          <cybox:Properties xsi:type="FileObj:FileObjectType">
           <FileObj:File_Name>drive.cab</FileObj:File_Name>
           <FileObj:Full_Path>C:\WINDOWS\Debug\Data</FileObj:Full_Path>
          </cybox:Properties>
          <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
         </cybox:Associated_Object>
        </cybox:Associated_Objects>
       </maecBundle:Action>
      </maecBundle:Actions>
    </maecPackage:Bundle>
    
    <maecPackage:Bundle id="maec-example-bnd-3" schema_version="4.0" defined_subject="false" content_type="manual analysis output">
     <maecBundle:Behaviors>
      <maecBundle:Behavior id="maec-example-bhv-1" ordinal_position="1" status="Success">
       <maecBundle:Description>Anti-virus software checking behavior. 
        The binary checks if the victim has Kaspersky, ESET, BitDefender, AVG, NOD32, Rising or 360+ installed by enumerating the values of a registry key.
       </maecBundle:Description>
       <maecBundle:Action_Composition>
        <maecBundle:Action_Reference action_id="maec-example-act-34"/>
       </maecBundle:Action_Composition>
      </maecBundle:Behavior>
      
      <maecBundle:Behavior id="maec-example-bhv-2" ordinal_position="2" status="Success">
       <maecBundle:Description>Concurrent execution prevention behavior.
        The binary creates a global mutex to mark its presence and prevent it being from re-executing on the system.</maecBundle:Description>
       <maecBundle:Action_Composition>
        <maecBundle:Action_Reference action_id="maec-example-act-9"/>
       </maecBundle:Action_Composition>
       <maecBundle:Relationships>
        <maecBundle:Relationship type="Preceded_By">
         <maecBundle:Behavior_Reference behavior_idref="maec-example-bhv-1"/>
        </maecBundle:Relationship>
       </maecBundle:Relationships>
      </maecBundle:Behavior>
      
      <maecBundle:Behavior id="maec-example-bhv-3" ordinal_position="3" status="Success">
       <maecBundle:Description>System instantiation behavior.
        The binary creates a copy of itself in several locations as a means of instantiating itself on the system, primarily for use in further behaviors.</maecBundle:Description>
       <maecBundle:Action_Composition>
        <maecBundle:Action_Reference action_id="maec-example-act-1" behavioral_ordering="1"/>
        <maecBundle:Action_Reference action_id="maec-example-act-5" behavioral_ordering="2"/>
       </maecBundle:Action_Composition>
       <maecBundle:Relationships>
        <maecBundle:Relationship type="Preceded_By">
         <maecBundle:Behavior_Reference behavior_idref="maec-example-bhv-2"/>
        </maecBundle:Relationship>
       </maecBundle:Relationships>
      </maecBundle:Behavior>
      
      <maecBundle:Behavior id="maec-example-bhv-4" ordinal_position="4" status="Success">
       <maecBundle:Description>Payload drop behavior.
        The binary drops its primary payload on the system.</maecBundle:Description>
       <maecBundle:Action_Composition>
        <maecBundle:Action_Reference action_id="maec-example-act-2"/>
       </maecBundle:Action_Composition>
       <maecBundle:Relationships>
        <maecBundle:Relationship type="Preceded_By">
         <maecBundle:Behavior_Reference behavior_idref="maec-example-bhv-3"/>
        </maecBundle:Relationship>
       </maecBundle:Relationships>
      </maecBundle:Behavior>
      
      <maecBundle:Behavior id="maec-example-bhv-5" ordinal_position="5" status="Success">
       <maecBundle:Description>File obfuscation behavior.
        The binary changes the modification, access, change time and properties of a file in order to obfuscate it.</maecBundle:Description>
       <maecBundle:Action_Composition>
        <maecBundle:Action_Reference action_id="maec-example-act-35"/>
       </maecBundle:Action_Composition>
       <maecBundle:Relationships>
        <maecBundle:Relationship type="Preceded_By">
         <maecBundle:Behavior_Reference behavior_idref="maec-example-bhv-4"/>
        </maecBundle:Relationship>
       </maecBundle:Relationships>
      </maecBundle:Behavior>
      
      <maecBundle:Behavior id="maec-example-bhv-6" ordinal_position="6" status="Success">
       <maecBundle:Description>Network activity obfuscation behavior.
        The binary copies two Windows system files of “netstat.exe” to
        C:\Windows\System32\13605 and “SFC_OS.dll” to C:\Windows\inf\1.txt. The
        “SFC_OS.dll” is the executable portion of Windows File Protection mechanism (WFP),
        which protects system files from being modified or deleted. The malware calls to ordinal
        5 function of “1.txt” in order to bypass the WFP (Collake, 2006) during patching
        "netstat.exe" for hiding network connection of IP address of 115.x.x.249</maecBundle:Description>
       <maecBundle:Action_Composition>
        <maecBundle:Action_Reference action_id="maec-example-act-36" behavioral_ordering="1"/>
        <maecBundle:Action_Reference action_id="maec-example-act-37" behavioral_ordering="2"/>
        <maecBundle:Action_Reference action_id="maec-example-act-4"  behavioral_ordering="3"/>
       </maecBundle:Action_Composition>
       <maecBundle:Relationships>
        <maecBundle:Relationship type="Preceded_By">
         <maecBundle:Behavior_Reference behavior_idref="maec-example-bhv-5"/>
        </maecBundle:Relationship>
       </maecBundle:Relationships>
      </maecBundle:Behavior>
     </maecBundle:Behaviors>
     
     <maecBundle:Actions>
      <maecBundle:Action id="maec-example-act-34" context="Host" action_status="Success">
       <cybox:Name xsi:type="maecVocabs:RegistryActionNameVocab-1.0">enumerate registry key values</cybox:Name>
       <cybox:Discovery_Method source_type="Tool">
        <cyboxCommon:Tools>
         <cyboxCommon:Tool idref="analysis-tool-8"/>
        </cyboxCommon:Tools>
       </cybox:Discovery_Method>
       <cybox:Associated_Objects>
        <cybox:Associated_Object id="maec-example-obj-36">
         <cybox:Properties xsi:type="WinRegistryKeyObj:WindowsRegistryKeyObjectType">
          <WinRegistryKeyObj:Key>SOFTWARE\Microsoft\windows\CurrentVersion\Uninstall</WinRegistryKeyObj:Key>
          <WinRegistryKeyObj:Hive>HKEY_LOCAL_MACHINE</WinRegistryKeyObj:Hive>
         </cybox:Properties>
         <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
        </cybox:Associated_Object>
       </cybox:Associated_Objects>
      </maecBundle:Action>
      
      <maecBundle:Action id="maec-example-act-35" context="Host" action_status="Success">
       <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">set file attributes</cybox:Name>
       <cybox:Discovery_Method source_type="Tool">
        <cyboxCommon:Tools>
         <cyboxCommon:Tool idref="analysis-tool-8"/>
        </cyboxCommon:Tools>
       </cybox:Discovery_Method>
       <cybox:Associated_Objects>
        <cybox:Associated_Object id="maec-example-obj-37">
         <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
          <FileObj:File_Name>msvcr.dll</FileObj:File_Name>
          <FileObj:Full_Path condition="FitsPattern" pattern_type="Regex">^C:\\Documents and Settings\\\s+user\s+\\Local Settings\\Application\\Data</FileObj:Full_Path>
         </cybox:Properties>
         <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
        </cybox:Associated_Object>
       </cybox:Associated_Objects>
      </maecBundle:Action>
      
      <maecBundle:Action id="maec-example-act-36" context="Host" action_status="Success">
       <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">copy file</cybox:Name>
       <cybox:Discovery_Method source_type="Tool">
        <cyboxCommon:Tools>
         <cyboxCommon:Tool idref="analysis-tool-8"/>
        </cyboxCommon:Tools>
       </cybox:Discovery_Method>
       <cybox:Associated_Objects>
        <cybox:Associated_Object id="maec-example-obj-38">
         <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
          <FileObj:File_Name>netstat.exe</FileObj:File_Name>
          <FileObj:Full_Path>C:\Windows\system32</FileObj:Full_Path>
         </cybox:Properties>
         <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
        </cybox:Associated_Object>
        <cybox:Associated_Object id="maec-example-obj-39">
         <cybox:Properties xsi:type="FileObj:FileObjectType">
          <FileObj:File_Name>13605</FileObj:File_Name>
          <FileObj:Full_Path>C:\Windows\system32</FileObj:Full_Path>
         </cybox:Properties>
         <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
        </cybox:Associated_Object>
       </cybox:Associated_Objects>
      </maecBundle:Action>
      
      <maecBundle:Action id="maec-example-act-37" context="Host" action_status="Success">
       <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">copy file</cybox:Name>
       <cybox:Discovery_Method source_type="Tool">
        <cyboxCommon:Tools>
         <cyboxCommon:Tool idref="analysis-tool-8"/>
        </cyboxCommon:Tools>
       </cybox:Discovery_Method>
       <cybox:Associated_Objects>
        <cybox:Associated_Object id="maec-example-obj-40">
         <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
          <FileObj:File_Name>SFC_OS.dll</FileObj:File_Name>
          <FileObj:Full_Path>C:\Windows\system32</FileObj:Full_Path>
         </cybox:Properties>
         <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
        </cybox:Associated_Object>
        <cybox:Associated_Object id="maec-example-obj-41">
         <cybox:Properties xsi:type="FileObj:FileObjectType">
          <FileObj:File_Name>1.txt</FileObj:File_Name>
          <FileObj:Full_Path>C:\Windows\inf</FileObj:Full_Path>
         </cybox:Properties>
         <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
        </cybox:Associated_Object>
       </cybox:Associated_Objects>
      </maecBundle:Action>
     </maecBundle:Actions>
    </maecPackage:Bundle>
   </maecPackage:Findings_Bundles>
  </maecPackage:Malware_Subject>
 </maecPackage:Malware_Subjects>
</maecPackage:MAEC_Package>
