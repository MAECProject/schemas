<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Action Equivalency Example
 -Demonstrates composition and usage of an Action Equivalency in a Package
 -The created Action Equivalency is used inside of a Behavior
 
 Created November 2012 for MAEC v3.0 and CybOX v1.0 final
 Updated April 2013 for MAEC v4.0 and CybOX v2.0 final 
 Updated September 2013 for MAEC v4.0.1 and CybOX v2.0.1
 Updated January 2014 for MAEC v4.1 and CybOX v2.1 
 Updated February 2014 with MAEC v4.1 Capability and label content 
 Updated May 2016 for MAEC 5.0 where the Action Equivalency is not longer contained inside a Behavior
 and is now captured in a top-level Relationship. The Behavior still references one or both of the 
 Actions (one is implicitly sufficient because of the relationship)-->
<maecPackage:MAEC_Package
 xmlns:maecCore="http://maec.mitre.org/XMLSchema/maec-core-1"
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-5"
 xmlns:maecVocabs="http://maec.mitre.org/XMLSchema/default_vocabularies-1"
 xmlns:cybox="http://cybox.mitre.org/cybox-2"
 xmlns:cyboxCommon="http://cybox.mitre.org/common-2"
 xmlns:cyboxVocabs="http://cybox.mitre.org/default_vocabularies-2"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject-2"
 xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject-2"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation=
 "http://maec.mitre.org/XMLSchema/maec-package-5 ../maec_package_schema.xsd
 http://maec.mitre.org/XMLSchema/maec-core-1 ../maec_core_schema.xsd
 http://maec.mitre.org/XMLSchema/default_vocabularies-1 ../maec_default_vocabularies.xsd
 http://cybox.mitre.org/default_vocabularies-2 http://cybox.mitre.org/XMLSchema/default_vocabularies/2.1/cybox_default_vocabularies.xsd
 http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/2.1/Win_Executable_File_Object.xsd
 http://cybox.mitre.org/objects#WinMutexObject http://cybox.mitre.org/XMLSchema/objects/Win_Mutex/2.1/Win_Mutex_Object.xsd 
 http://cybox.mitre.org/objects#WinProcessObject http://cybox.mitre.org/XMLSchema/objects/Win_Process/2.1/Win_Process_Object.xsd 
 http://cybox.mitre.org/objects#URIObject http://cybox.mitre.org/XMLSchema/objects/URI/2.1/URI_Object.xsd" 
 id="maec-example-pkg-1" schema_version="5.0">

 <maecPackage:Malware_Subjects>
  <maecPackage:Malware_Subject id="maec-example-sub-1">
   <maecPackage:Instance_Object object_idref="maec-sub-obj-1"/>
   
   <maecPackage:Label xsi:type="maecVocabs:MalwareLabelVocab-1.0">dropper file</maecPackage:Label>
   
   <maecPackage:Analyses>
    <maecPackage:Analysis id="maec-example-ana-1" method="dynamic" type="triage">
     <maecPackage:Summary>Dynamic (behavioral) triage of the subject binary.</maecPackage:Summary>
     <maecPackage:Discovered_Entities>
      <maecPackage:Action_Reference action_id="maec-anubis_to_maec-act-1"/>
     </maecPackage:Discovered_Entities>
     <maecPackage:Tools>
      <maecPackage:Tool_Reference tool_idref="analysis-tool-1"/>
     </maecPackage:Tools>
    </maecPackage:Analysis>
    
    <maecPackage:Analysis id="maec-example-ana-2" method="dynamic" type="triage">
     <maecPackage:Summary>Dynamic (behavioral) and tool-based triage of the subject binary.</maecPackage:Summary>
     <maecPackage:Discovered_Entities>
      <maecPackage:Action_Reference action_id="maec-threatexpert_to_maec-act-1"/>
     </maecPackage:Discovered_Entities>
     <maecPackage:Tools>
      <maecPackage:Tool_Reference tool_idref="analysis-tool-2"/>
     </maecPackage:Tools>
    </maecPackage:Analysis>
    
    <maecPackage:Analysis id="maec-example-ana-3" method="static" type="in-depth">
     <maecPackage:Summary>Manual analysis of the subject binary.</maecPackage:Summary>
     <maecPackage:Discovered_Entities>
      <maecPackage:Capability_Reference capability_idref="maec-example-cpb-1"/>
      <maecPackage:Behavior_Reference behavior_idref="maec-example-bhv-1"/>
     </maecPackage:Discovered_Entities>
    </maecPackage:Analysis>
   </maecPackage:Analyses>
  </maecPackage:Malware_Subject>
 </maecPackage:Malware_Subjects>
 
 <maecPackage:Capabilities>
  <maecCore:Capability id="maec-example-cpb-1">
   <maecCore:Name xsi:type="maecVocabs:CapabilityVocab-1.0">persistence</maecCore:Name>
   <maecCore:Refined_Capability id="maec-example-refcpb-1">
    <maecCore:Name xsi:type="maecVocabs:RefinedCapabilityVocab-1.0">continuous execution</maecCore:Name>
   </maecCore:Refined_Capability>
   <maecCore:Attribute>
    <maecCore:Name xsi:type="maecVocabs:CapabilityAttributeVocab-1.0">persistence scope</maecCore:Name>
    <maecCore:Value>self</maecCore:Value>
   </maecCore:Attribute>
   <maecCore:Behavior_Reference behavior_idref="maec-example-bhv-1"/>
  </maecCore:Capability>
 </maecPackage:Capabilities>
 
 <maecPackage:Behaviors>
  <maecCore:Behavior id="maec-example-bhv-1">
   <maecCore:Name xsi:type="maecVocabs:BehaviorVocab-1.0">persist after system reboot</maecCore:Name>
   <maecCore:Description>A persistence after reboot behavior using the Windows startup folder.</maecCore:Description>
   <maecCore:Action_Reference action_id="maec-anubis_to_maec-act-1"/>
   <maecCore:Action_Reference action_id="maec-threatexpert_to_maec-act-1"/>
  </maecCore:Behavior>
 </maecPackage:Behaviors>
 
 <maecPackage:Actions>
  <maecCore:Action action_status="Success" id="maec-anubis_to_maec-act-1">
   <maecCore:Name xsi:type="maecVocabs:MalwareActionVocab-1.0">create file</maecCore:Name>
   <maecCore:Associated_Object_Reference object_idref="maec-anubis_to_maec-obj-2" association_type="output"/>
  </maecCore:Action>
  <maecCore:Action action_status="Success" id="maec-threatexpert_to_maec-act-1">
   <maecCore:Name xsi:type="maecVocabs:MalwareActionVocab-1.0">create file</maecCore:Name>
   <maecCore:Associated_Object_Reference object_idref="maec-threatexpert_to_maec-obj-3" association_type="output"/>
  </maecCore:Action>
 </maecPackage:Actions>
 
 <maecPackage:Objects>
  <maecCore:Object id="maec-sub-obj-1">
   <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
    <FileObj:File_Name>2ed2386bfb.exe</FileObj:File_Name>
    <FileObj:File_Path>C:\2ed2386bfb.exe</FileObj:File_Path>
    <FileObj:Size_In_Bytes>379077</FileObj:Size_In_Bytes>
    <FileObj:Hashes>
     <cyboxCommon:Hash>
      <cyboxCommon:Type xsi:type="cyboxVocabs:HashNameVocab-1.0">MD5</cyboxCommon:Type>
      <cyboxCommon:Simple_Hash_Value>2ed2386bfbd31a1104e402a0c97c1aa6</cyboxCommon:Simple_Hash_Value>
     </cyboxCommon:Hash>
     <cyboxCommon:Hash>
      <cyboxCommon:Type xsi:type="cyboxVocabs:HashNameVocab-1.0">SHA1</cyboxCommon:Type>
      <cyboxCommon:Simple_Hash_Value>611a0dae515ea4606c1e3b768145af902ed5f349</cyboxCommon:Simple_Hash_Value>
     </cyboxCommon:Hash>
    </FileObj:Hashes>
   </cybox:Properties>
  </maecCore:Object>
  <maecCore:Object id="maec-anubis_to_maec-obj-2">
   <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
    <FileObj:File_Name>taskmgrsx.exe</FileObj:File_Name>
    <FileObj:File_Path>C:\Documents and Settings\Administrator\Start Menu\Programs\Startup\</FileObj:File_Path>
   </cybox:Properties>
  </maecCore:Object>
  <maecCore:Object id="maec-threatexpert_to_maec-obj-3">
   <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
    <FileObj:File_Name>taskmgrsx.exe</FileObj:File_Name>
    <FileObj:File_Path>%Programs%\Startup\</FileObj:File_Path>
   </cybox:Properties>
  </maecCore:Object>
 </maecPackage:Objects>
 
 <maecPackage:Tools>
  <cyboxCommon:Tool id="analysis-tool-1">
   <cyboxCommon:Name>Anubis</cyboxCommon:Name>
   <cyboxCommon:Vendor>IsecLab</cyboxCommon:Vendor>
  </cyboxCommon:Tool>
  <cyboxCommon:Tool id="analysis-tool-2">
   <cyboxCommon:Name>ThreatExpert</cyboxCommon:Name>
   <cyboxCommon:Vendor>Symantec</cyboxCommon:Vendor>
  </cyboxCommon:Tool>
 </maecPackage:Tools>
 
 <maecPackage:Relationships>
  <maecPackage:Relationship source_id="maec-anubis_to_maec-act-1" target_id="maec-threatexpert_to_maec-act-1">
   <maecPackage:Type xsi:type="maecVocabs:GeneralRelationshipTypeVocab-1.0">equivalent</maecPackage:Type>
  </maecPackage:Relationship>
 </maecPackage:Relationships>
</maecPackage:MAEC_Package>
