<?xml version="1.0" encoding="UTF-8"?>
<!-- MAEC Capability/Objective Properties Example
     Describes SpyEye capabilities
     Based on IOActive report: http://www.ioactive.com/pdfs/ZeusSpyEyeBankingTrojanAnalysis.pdf
     Added February 2014 for MAEC v4.1 -->
<maecPackage:MAEC_Package
    xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-2"
    xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-4"
    xmlns:maecVocabs="http://maec.mitre.org/default_vocabularies-1"
    xmlns:cybox="http://cybox.mitre.org/cybox-2"
    xmlns:cyboxCommon="http://cybox.mitre.org/common-2"
    xmlns:cyboxVocabs="http://cybox.mitre.org/default_vocabularies-2"
    xmlns:FileObj="http://cybox.mitre.org/objects#FileObject-2"
    xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject-2"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-package-2 ../maec_package_schema.xsd
    http://maec.mitre.org/default_vocabularies-1 ../maec_default_vocabularies.xsd
    http://cybox.mitre.org/default_vocabularies-2 http://cybox.mitre.org/XMLSchema/default_vocabularies/2.1/cybox_default_vocabularies.xsd 
    http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/2.1/Win_Executable_File_Object.xsd" 
    id="maec-example-pkg-1" schema_version="2.1">
    <maecPackage:Malware_Subjects>
        <maecPackage:Malware_Subject id="maec-tst-sub-1">
            <maecPackage:Malware_Instance_Object_Attributes id="maec-tst-obj-1">
                <cybox:Properties xsi:type="FileObj:FileObjectType">
                    <FileObj:File_Name>cleansweep.exe</FileObj:File_Name>
                    <FileObj:File_Path>C:/cleansweep.exe/</FileObj:File_Path>
                </cybox:Properties>
            </maecPackage:Malware_Instance_Object_Attributes>
            
            <maecPackage:Label xsi:type="maecVocabs:MalwareLabelVocab-1.0">dropper file</maecPackage:Label>
            <maecPackage:Label xsi:type="maecVocabs:MalwareLabelVocab-1.0">downloader</maecPackage:Label>
            
            <maecPackage:Relationships>
                <maecPackage:Relationship>
                    <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.1">drops</maecPackage:Type>
                    <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-tst-sub-2"/>
                </maecPackage:Relationship>
                <maecPackage:Relationship>
                    <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.1">extracts</maecPackage:Type>
                    <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-tst-sub-3"/>
                </maecPackage:Relationship>
                <maecPackage:Relationship>
                    <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.1">downloads</maecPackage:Type>
                    <maecPackage:Malware_Subject_Reference malware_subject_idref="maec-tst-sub-4"/>
                </maecPackage:Relationship>
            </maecPackage:Relationships>
        </maecPackage:Malware_Subject>
        
        <!-- Configuration Archive -->
        <maecPackage:Malware_Subject id="maec-tst-sub-2">
            <maecPackage:Malware_Instance_Object_Attributes id="maec-tst-obj-2">
                <cybox:Description>Password protected zip archive with first two bytes of header overwritten.</cybox:Description>
                <cybox:Properties xsi:type="FileObj:FileObjectType">
                    <FileObj:File_Name>config.bin</FileObj:File_Name>
                    <FileObj:File_Path>C:/cleansweep.exe/</FileObj:File_Path>
                </cybox:Properties>
            </maecPackage:Malware_Instance_Object_Attributes>
        </maecPackage:Malware_Subject>
        
        <!-- Configuration File -->
        <maecPackage:Malware_Subject id="maec-tst-sub-3">
            <maecPackage:Malware_Instance_Object_Attributes id="maec-tst-obj-3">
                <cybox:Description>Configuration file.</cybox:Description>
                <cybox:Properties xsi:type="FileObj:FileObjectType">
                    <FileObj:File_Name>config.dat</FileObj:File_Name>
                    <FileObj:Size_In_Bytes>13005</FileObj:Size_In_Bytes>
                </cybox:Properties>
            </maecPackage:Malware_Instance_Object_Attributes>
        </maecPackage:Malware_Subject>
        
        <!-- Updater/Installer -->
        <maecPackage:Malware_Subject id="maec-tst-sub-4">
            <maecPackage:Malware_Instance_Object_Attributes id="maec-tst-obj-4">
                <cybox:Properties xsi:type="FileObj:FileObjectType">
                    <FileObj:File_Name>cleansweepupd.exe</FileObj:File_Name>
                </cybox:Properties>
            </maecPackage:Malware_Instance_Object_Attributes>
        </maecPackage:Malware_Subject>
        
    </maecPackage:Malware_Subjects>
</maecPackage:MAEC_Package>