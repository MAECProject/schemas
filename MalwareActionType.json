{
	"$schema": "http://json-schema.org/draft-04/schema#",
	"definitions":{
		"MalwareActionType" : {
			"type":"object",
			"description":"The MalwareActionType is one of the foundational MAEC types, and serves as a method for the characterization of actions found or observed in malware. Actions can be thought of as system state changes and similar operations that represent the fundamental low-level operation of malware. Some examples include the creation of a file, deletion of a registry key, and the sending of some  data on a socket.",
			"properties":{
				"Name": {"$ref": "#/REFERENCE PLACEHOLDER FOR cyboxCommon:ControlledVocabularyStringType"},
				"Description":{"$ref" :" REFERENCE PLACEHOLDER FOR cybox:Common:StructuredTextType", "description": "The Description field contains a textual description of the Malware Action."},
				"Associated_Object_Reference": {"$ref": "#/definitions/AssociatedObjectReferenceType"},
				"Implementation":{"$ref": "#definitions/ActionImplementationType"},
				"id": {"type": "string", "description" : "The required id field specifies a unique id for this Malware Action."},
				"timestamp": {"type":"string", "format":"date-time", "description":"The timestamp field represents the local or relative time at which the action occurred or was observed. In order to avoid ambiguity, it is strongly suggest that all timestamps in this field include a specification of the timezone if it is known, via the timestamp_precision field."},
				"timestamp_precision": {"$ref": "REFERENCE PLACEHOLDER FOR cyboxCommon:DateTimePrecisionEnum" , "description": "Represents the precision of the associated timestamp value. If omitted, the default is \"second\", meaning the timestamp is precise to the full field value. Digits in the timestamp that are required by the xs:dateTime datatype but are beyond the specified precision should be zeroed out."},
				"action_status": {"$ref": "REFERENCE PLACEHOLDER FOR cybox:ActionStatusTypeEnum", "description": "The action_status field captures the status of the Malware Action, with respect to the success of its execution."},
				"count":{"type":"integer", "minimum": 0, "description":"The count field captures how many times the Malware Action was observed, for cases where the same action is seen multiple times. In such cases, the timestamp field should be used to capture the first time the action was observed."}
			},
			"required": ["id"]
		},
		"AssociatedObjectReferenceType":{
			"type": "object",
			"description": "The Associated_Object_Reference captures a reference to a CybOX Object associated with the Malware Action, including those used as input into the Malware Action, resulting as output from the Malware Action, and resulting as a side effect from the Malware Action.",
			"properties":{
				"object_idref": {"type":"string", "description": "The object_idref field serves as a reference to an existing CybOX Object in the MAEC document, via its ID."},
				"association_type": {"type":"string","enum":["input","output","side-effect"],"description": "The 'input' value specifies that the associated object serves as an input to the action. This includes cases where an object is used by the action or an existing object is modified by the action. The 'output' value specifies that the associated object serves as an output to the action. This includes cases where the object is created anew by the action or otherwise returned by the action. The 'side-effect' value specifies that the associated object serves as a side-effect resulting from the action. This includes cases where the object is modified indirectly by the action."}
			},
			"required":	["object_idref","association_type"]
		},
		"ActionImplementationType":{
			"type": "object",
			"description" : "The ActionImplementationType serves as a method for the characterization of Action Implementations. Currently supported are implementations achieved through API function calls and abstractly defined code.",
			"properties":{
				"Compatible_Platforms": {"$ref":"#/definitions/PlatformListType"},
				"API_Call_or_Code": {
					"type":"object",
					"description": "This field is for either an APICallType or ObjectReferenceType(code) ",
					"oneOf":[
						{"$ref":"#/definitions/APICallType"},
						{"$ref": "#/definitions/ObjectReferenceType"}
					]
				},
				"id":{"type": "string","description":"The id field specifies a unique ID for this action Implementation"},
				"type": {"$ref":"#/definitions/ActionImplementationTypeEnum"}
			},
			"required":["id"]	
		},
		"PlatformListType":{
			"type":"object",
			"description" : "The PlatformListType captures a list of software or hardware platforms.",
			"properties":{
				"Platform":{ "$ref": "#/REFERENCE PLACEHOLDER FOR cyboxCommon:PlatformSpecificationType", "description":"The Platform field specifies a single Platform in the list via a common platform enumeration ID. It uses the PlatformSpecificationType type from the CybOX Common schema v2.0.1."}
			}
		},
		"APICallType":{
			"type":"object",
			"description":"The APICallType provides a method for the  characterization of API calls, including functions and their parameters.",
			"properties": {
				"Address":{"type":"string", "pattern": "^[123456789abcdefABCDEF]+$" , "description":"The Address field contains the address of the API call in the binary(in hex encoded binary)."},
				"Return_Value": {"type":"string","description" : "The Return_Value field contains the return value of the API call."},
				"Parameters":{"$ref":"#definitions/ParameterListType"},
				"function_name": {"type":"string", "description": "The function_name field contains the exact name of the API function called, e.g. CreateFileEx." },			
				"normalized_function_name": {"type": "string", "description": "The normalized_function_name field contains the normalized name of the API function called, e.g. CreateFile."}
			}
		},
		"ParameterListType": {
			"type:": "object",
			"description": "The ParametersType captures a list of function parameters.",
			"properties":{
				"Parameter": {"$ref": "#/definitions/ParameterType"}
			}
		},
		"ParameterType":{
			"type": "object",
			"description": "The ParameterType characterizes function parameters.",
			"properties":{
				"ordinal_position": {"type":"integer","minimum": 0, "description": "This field refers to the ordinal position of the parameter with respect to the function where it is used."},
				"name": {"type": "string", "description": "The name field specifies the name of the parameter"},
				"value":{"type": "string", "description": "The value field specifies the actual value of the parameter"}
			}
		},
		"ObjectReferenceType": {
			"type": "object",
			"description": "The ObjectReferenceType serves as a method for linking to CybOX Objects defined in the Package.",
			"properties":{
				"object_idref": {"type": "string", "description": "The object_idref field specifies the id of the CybOX Object being referenced."}
			},
			"required":["object_idref"]
		},
		"ActionImplementationTypeEnum":{
			"type": "object",
			"description":"The ActionImplementationTypeEnum represents an enumeration of action implementation types.",
			"properties":{
				"action_implemenation_type":{"type": "string", "enum": ["api call","code"], "description": "The api call value specifies that the action was implemented using some particular API call, details of which may be captured in the API_Call element. The Code value specifies that the action was implemented using some particular code snippet, details of which may be captured in the Code element."}
			}
		},
		"ActionListType":{
			"type":"object",
			"description":"The ActionListType captures a list of Actions",
			"properties":{
				"Action":{"$ref":"#/definitions/MalwareActionType","description":"The Action field specifies a single Action in the list. The reccomended syntax for Action IDs is a dash -delimited format that starts with the word maec, followed by a uniaue string, followed by the three letter code 'act', and ending with an integer. The regular expression validating these IDs is: maec-[A-Za-z0-9_\\-\\.]+-act-[1-9][0-9]*. "}
			},
			"required":["Action"]
		},
		"ObjectListType":{
			"type":"object",
			"description":"The ObjectListType captures a list of CybOX Objects",
			"properties":{
				"Object":{"$ref":"REFERENCE PLACEHOLDER FOR cybox:ObjectType","description":"The Oject field specifies a single CybOX Object in the list. For use in the MAEC, the id attribute at the top level of the Object must be utilized"}
			},
			"maxProperties":1
		},
		"ObjectReferenceListType":{
			"type":"object",
			"description":"The ObjectReferenceListType captures a list of references to CybOX Objects",
			"properties":{
				"Object_Reference": {"$ref":"#/definitions/ObjectReferenceType","description":"The Object_Reference field specifies a reference to a single CybOX Object"}
			}
		}
	}
}